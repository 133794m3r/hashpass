perc=0;function generate_salt(a,b,c,d){d=void 0===d?!1:d;var g=Date.now(),e=7,h=1,k=8,f=9,l=1,m=6;!1===d&&(e=9,h=1,f=14,k=9,m=8,l=1);a=scrypt(a,c,{log_n:e,r:m,p:h,encoding:"base64"});b=scrypt(b,a,{log_n:e,r:m,p:h,encoding:"hex"});c=scrypt(c,b,{log_n:e,r:m,p:h,encoding:"base64"});salt2=b+c+a;a=scrypt(c+a+b,salt2,{log_n:f,r:k,p:l,encoding:"hex"});b=Date.now();console.log("gen_salt:"+(b-g)+"ms");console.log(a);return a}
function generate_salt_argon2(a,b,c){a=Date.now();b=Date.now();console.log("gen_salt:"+(b-a)+"ms");console.log(salt);return salt}
function simplify(a,b,c,d){var g=Date.now(),e=a.replace(/[^0-9]/g,""),h="";a=a.replace(/[^a-z]/g,"");console.log(a);var k=a.substr(1);var f=k=no_repeat_strings(k);k=a.substr(0,1).toUpperCase();var l=e.substr(0,1);e=e.substr(1);e=no_repeat_strings(e);var m=parseInt(e.substr(0,2))%3;if(!1===c)switch(m){case 0:h="$";break;case 1:h="#";break;case 2:h="@"}else h=5<=e.length?e.substr(-1,1):f.substr(-1,1);5<=e.length?(num_str_len=Math.floor(b/2),f=f.substr(0,num_str_len-2),e=e.substr(0,b-num_str_len-1)):
(b-=e.length,f=f.substr(0,b-3),e.substr(0));if(!0===d)switch(b=(a.charCodeAt(1)+a.charCodeAt(1)+a.charCodeAt(2))%5,b){case 0:a=l+k+f+e+h;break;case 1:a=k+l+f+e+h;break;case 2:a=l+k+e+f+h;break;case 3:a=e+k+f+l+h;break;case 4:a=e+k+l+f+h}else switch(b=(a.charCodeAt(1)+a.charCodeAt(1)+a.charCodeAt(2))%10,b){case 0:a=k+l+f+e+h;break;case 1:a=h+e+k+f+l;break;case 2:a=l+h+k+e+f;break;case 3:a=k+e+h+f+l;break;case 4:a=e+k+f+h+l;break;case 5:a=e+k+l+f+h;break;case 6:a=h+e+f+l+k;break;case 7:a=e+h+f+k+l;
break;case 8:a=f+e+h+k+l;break;case 9:a=l+f+e+h+k}h=Date.now();console.log("pass "+a);console.log("simplify:"+(h-g)+"ms");return a}
function generate_pass(a){a=void 0===a?!1:a;document.getElementsByTagName("input");var b=[];var c=1;var d=10,g=15,e=document.getElementById("no_spec").checked,h=document.getElementById("no_legacy").checked;var k=document.getElementById("site_name").value;var f=document.getElementById("password").value;var l=document.getElementById("username").value;var m=document.getElementById("length").value;b[0]=l;b[1]=k;""===m&&(m=14,document.getElementById("length").value=14);if(""!==f){var n=f.length;f=f.substr(0,
1).toUpperCase()+f.substr(1,n);document.getElementById("password").value=f}""!==l&&(l=l.substr(0,1).toUpperCase()+l.substr(1),document.getElementById("username").value=l);""!==k&&(k=k.substr(0,1).toUpperCase()+k.substr(1),document.getElementById("site_name").value=k);var p=zxcvbn(f,b);n=p.feedback.warning;console.log(p.guesses);console.log(n);n="Try adding a word or two, less common words are better. Or try adding a few numbers. "+n;document.getElementById("orig_score").innerHTML=p.score;1>=p.score&&
(b[0]==b[1]||b[0]==f||b[1]==f)?document.getElementById("feedback").innerHTML="Do not use your username or site name in the password! "+n:2>=p.score?(console.log("hit"),document.getElementById("feedback").innerHTML=n):document.getElementById("feedback").innerHTML="Score is 3 or above and thus suggestions not necessary";!1===h?(document.getElementById("orig_time").innerHTML=display_time(p.guesses/1300),c=2,d=6,g=16):document.getElementById("orig_time").innerHTML=display_time(p.guesses/3600);n=Date.now();
l=generate_salt(f,l,k,h);p=Date.now();f=scrypt(f,l,{log_n:g,r:d,p:c,encoding:"hex"});c=Date.now();console.log("scrypt time:"+(c-p)+"ms");f=hex_decode(f);f=base32_encode(f);console.log("scrypt:"+f);f=simplify(f,m,e,h);document.getElementById("result").value=f;m=Date.now();e=m-n;console.log("total:"+(m-n)+"ms");!0===a&&alert("total new values:"+e);n=Date.now();p=zxcvbn(f,b);m=Date.now();console.log("zxcvbn:"+(m-n)+"ms");document.getElementById("gen_score").innerHTML=p.score;document.getElementById("gen_time").innerHTML=
display_time(p.guesses/9E3);modal_toggle("_progress");document.getElementById("generate_pass").disabled=!1}function percent_update(a){var b=document.getElementById("completed_perc"),c=document.getElementById("perc_text"),d=document.getElementById("perc_done");a+="%";c.innerHTML=a;d.innerHTML=a;b.style.width=a}function modal_toggle(a){a=document.getElementById("modal"+a);a.style.visibility="visible"===a.style.visibility?"hidden":"visible";return 0}
function no_spec_check(){!0===document.getElementById("no_spec").checked&&modal_toggle("_spec");return 0}function no_legacy_check(){!0===document.getElementById("no_legacy").checked&&modal_toggle("_legacy");return 0}function confirmed(a,b){document.getElementById("no"+b).checked=a;modal_toggle(b);return 0}
function generate_wrapper(a){a=void 0===a?!1:a;setTimeout(function(){document.getElementById("modal_progress").style.visibility="visible"},0);setTimeout(function(){document.getElementById("generate_pass").disabled=!0},1);setTimeout(function(){percent_update(70)},2);setTimeout(function(){generate_pass(a)},45)}
function score_password(){document.getElementById("no_legacy");var a=[];url=document.getElementById("site_name").value;password=document.getElementById("password").value;username=document.getElementById("username").value;max_len=document.getElementById("length").value;console.log("hits");""!==password&&(password=password.substr(0,1).toUpperCase()+password.substr(1),document.getElementById("password").value=password);""!==username&&(username=username.substr(0,1).toUpperCase()+username.substr(1),document.getElementById("username").value=
username);""!==url&&(url=url.substr(0,1).toUpperCase()+url.substr(1),document.getElementById("site_name").value=url);a[0]=username;a[1]=url;var b=zxcvbn(password,a);var c="Try adding a word or two, less common words are better. Or try adding a few numbers. "+b.feedback.warning;document.getElementById("orig_score").innerHTML=b.score;1>=b.score&&(a[0]==a[1]||a[0]==password||a[1]==password)?document.getElementById("feedback").innerHTML="Do not use your username or site name in the password! "+c:2>=b.score?
(console.log("hit"),document.getElementById("feedback").innerHTML=c):document.getElementById("feedback").innerHTML="Score is 3 or above and thus suggestions not necessary";document.getElementById("orig_time").innerHTML=display_time(b.guesses/3E3)};function pow(a,b){return Math.pow(a,b)}function sqrt(a){return Math.sqrt(a)}function ceil(a){return Math.ceil(a)}function getint(a){return parseInt($(a).val())}function floor(a){return Math.floor(a)}function intval(a){return parseInt(a)}function rand(a,b){void 0===b&&(b=a,a=0);return Math.floor(Math.random()*(b-a))+a}function round(a,b){var c=0;void 0!==b&&(c=parseFloat(a.toFixed(b)));a=Math.round(a,5);return c!==a&&void 0!==b?parseFloat(c):parseInt(a)}
function mean(a){var b=a.length,c,d=0;for(c=0;c<b;++c)d+=a[c];return round(d/b,8)}function standard_deviation(a,b){var c=a.length,d,g=0;for(d=0;d<c;++d)g+=pow(a[d]-b,2);return g=round(sqrt(g/c),8)}function randfloat(a,b,c){var d=Math.pow(10,c);a+=(b-a)*(rand(0,d)/d);return a=round(a,c)}function sum(a,b,c,d){for(var g;b<c;++b)g+=eval(d),++a}function num_format(a){str=a+"";x=str.split(".");x1=x[0];x2=1<x.length?"."+x[1]:"";for(a=/(\d+)(\d{3})/;a.test(x1);)x1=x1.replace(a,"$1,$2");return x1+x2}
function float_bin(a){var b=a.split(".");var c=parseFloat("0."+b[1]),d=1;a=0;1<Math.abs(b[0])?(b=Math.abs(b[0]).toString(2),a=b.length,b+="."):b="0.";for(;0!==d&&24>a;)d=c*=2,d=Math.floor(d),b+=d,c+="",d=c.split("."),d=parseInt(d[1]),++a;c=b.split(".");a=0==parseInt(c[0])?c[0].length:c[1].length;for(c=0;c<a;++c);}function bin_float(a){}
function xor_rand(a,b){var c=window.screenX^window.screen.width;var d=window.screenY^window.screen.height;Math.rand();var g=Math.floor(4294967295*Math.rand());g=(g^g<<1)>>3;g^=g<<10;c^=c<<16;var e=c>>5^c<<1;d=(d^d>>2)<<5;d^=d>>15;var h=(g&6)+(c&6)+(d&6)+(e&6)+3,k;for(k=0;k<h;++k)g^=g<<1,g>>=3,g^=g<<10,c^=c<<16,e=c>>5,e^=c<<1,d^=d>>2,d<<=5,d^=d>>15;h*=2;for(k=0;k<h;++k){var f=c^c<<20^d^d>>11^e^e<<27^g^g>>6;c=d;d=e;e=g;g=f}return a||b?Math.floor(g*(b-a))+a:g&4294967295}
function microtime(){return Date.now()/1E3}function display_time(a){var b;a=1>a?[null,"less than a second"]:60>a?(b=Math.round(a),[b,b+" second"]):3600>a?(b=Math.round(a/60),[b,b+" minute"]):86400>a?(b=Math.round(a/3600),[b,b+" hour"]):2678400>a?(b=Math.round(a/86400),[b,b+" day"]):32140800>a?(b=Math.round(a/2678400),[b,b+" month"]):321408E4>a?(b=Math.round(a/32140800),[b,b+" year"]):[null,"centuries"];b=a[0];a=a[1];null!=b&&1!==b&&(a+="s");return a};function base32_encode(a){var b="",c=Math.floor(a.length/5),d=a.length%5,g="";0!=d&&(c+=1);for(i=0;i<c;i++){var e=a.charCodeAt(5*i);var h=a.charCodeAt(5*i+1);var k=a.charCodeAt(5*i+2);var f=a.charCodeAt(5*i+3);var l=a.charCodeAt(5*i+4);var m=e>>3;e=(e&7)<<2|h>>6;var n=(h&63)>>1;h=(h&1)<<4|k>>4;k=(k&15)<<1|f>>7;parts6=(f&127)>>2;f=(f&3)<<3|l>>5;l&=31;b+="ybndrfg8ejkmcpqxot1uwisza345h769".charAt(m)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(e)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(n)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(h)+
"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(k)+"y"+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(f)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(l)}a=0;1==d?a=6:2==d?a=4:3==d?a=3:4==d&&(a=1);d=8*i;for(i=0;i<a;i++)g+="=";return b=b.substr(0,d-a)+g}function hex_decode(a){var b=Math.ceil(a.length/2),c,d="";for(c=0;c<b;c++)d+=String.fromCharCode(parseInt(a.substr(2*c,2),16));return d}
function string_indexes(a,b){for(var c,d=0,g=[],e=0,h=0;null!==d;)c=a.substr(d),d=c.match(b),null!==d&&(g[h++]=c.indexOf(d[0])+e,e=d=c.indexOf(d[0])+1+e);return g}
function no_repeat_strings(a){for(var b="",c=a.length,d="",g=a.substr(0,1),e,h=1,k=1,f=0,l=0,m=0;1===h;)k>c&&1<=f&&100>=l?(m=m+k+l,k=1,a=b+d,a.substr(-1,1)===a.substr(-2,1)?(ins_place=m%c,a=a.substr(0,ins_place)+a.substr(-1,1)+a.substr(ins_place,c-1)):a.substr(0,1)===a.substr(1,1)&&(ins_place=m%c,a=a.substr(0,ins_place)+a.substr(-1,1)+a.substr(ins_place,c-1)),g=a.substr(0,1),f=0,h=1,b=d="",l+=1):k>c&&(h=0),e=a.substr(k,1),g==e?(b+=g,f=b.length):d+=g,g=e,k+=1;return a}
function b64_encode(a,b){var c,d="",g=[],e=0,h=c=0,k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".split("");if(0==(void 0===b?!1:b))for(;b=a.charCodeAt(c++);)128>b?g[h]=b:(2048>b?g[h]=192|b>>6:(65536>b?g[h]=224|b>>12:(g[h]=240|b>>18,g[h]=128|b>>12&63),g[h]=128|b>>6&63),g[h]=128|b&63),++h;else g=a,h=g.length;for(console.log(g);e<h;)a=g[e++],c=g[e++],b=g[e++],d+=k[a>>2],d+=k[(a&3)<<4|c>>4],d+=k[void 0===c?64:(c&15)<<2|b>>6],d+=k[void 0===b?64:b&63];return d}
function b64_decode(a){for(var b,c,d,g,e=0,h=a.length,k=[],f;e<h;)b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(e)),c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(e+1)),d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e+2,1),g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e+3,1),b=b<<2|c>>4,c=(c&15)<<4|d>>2,f=(d&3)<<6|chr4,k+=String.fromCharCode(b),64!==d?k+=
String.fromCharCode(c):64!==g&&(k+=String.fromCharCode(f)),++e;return k=unescape(k)};
