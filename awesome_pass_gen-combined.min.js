perc=0;function generate_salt(a,b,c,e){e=void 0===e?!1:e;var h=Date.now(),d="",g=7,f=1,k=8,l=9,m=1,n=6;!1===e&&(g=9,f=1,l=14,k=9,n=8,m=1);scrypt(a,c,{logN:g,r:n,p:f,encoding:"base64"},function(b){a=b});scrypt(b,a,{logN:g,r:n,p:f,encoding:"hex"},function(a){b=a});scrypt(c,b,{logN:g,r:n,p:f,encoding:"base64"},function(a){c=a});d=c+a+b;salt2=b+c+a;scrypt(d,salt2,{logN:l,r:k,p:m,encoding:"hex"},function(a){d=a});e=Date.now();console.log("gen_salt:"+(e-h)+"ms");console.log(d);return d}
function simplify(a,b,c,e){var h=Date.now(),d=RegExp("[^a-z]","g"),g=a.replace(RegExp("[^0-9]","g"),""),f,k,l="";a=a.replace(d,"");console.log(a);var m,d=a.substr(1);f=d=no_repeat_strings(d);d=a.substr(0,1).toUpperCase();k=g.substr(0,1);g=g.substr(1);g=no_repeat_strings(g);m=parseInt(g.substr(0,2))%3;if(!1===c)switch(m){case 0:l="$";break;case 1:l="#";break;case 2:l="@"}else l=5<=g.length?g.substr(-1,1):f.substr(-1,1);5<=g.length?(num_str_len=Math.floor(b/2),f=f.substr(0,num_str_len-2),g=g.substr(0,
b-num_str_len-1)):(b-=g.length,f=f.substr(0,b-3),g.substr(0));if(!0===e)switch(b=(a.charCodeAt(1)+a.charCodeAt(1)+a.charCodeAt(2))%5,b){case 0:a=k+d+f+g+l;break;case 1:a=d+k+f+g+l;break;case 2:a=k+d+g+f+l;break;case 3:a=g+d+f+k+l;break;case 4:a=g+d+k+f+l}else switch(b=(a.charCodeAt(1)+a.charCodeAt(1)+a.charCodeAt(2))%10,b){case 0:a=d+k+f+g+l;break;case 1:a=l+g+d+f+k;break;case 2:a=k+l+d+g+f;break;case 3:a=d+g+l+f+k;break;case 4:a=g+d+f+l+k;break;case 5:a=g+d+k+f+l;break;case 6:a=l+g+f+k+d;break;case 7:a=
g+l+f+d+k;break;case 8:a=f+g+l+d+k;break;case 9:a=k+f+g+l+d}l=Date.now();console.log("pass "+a);console.log("simplify:"+(l-h)+"ms");return a}
function generate_pass(a){a=void 0===a?!1:a;document.getElementsByTagName("input");var b="",c=14,e=[],h="",d="",g="",f="",k=0,f=b=c=0,b=b="",k=1,l=10,m=15,n=document.getElementById("no_spec").checked,p=document.getElementById("no_legacy").checked,g=document.getElementById("site_name").value,d=document.getElementById("password").value,h=document.getElementById("username").value,c=document.getElementById("length").value;e[0]=h;e[1]=g;""===c&&(c=14,document.getElementById("length").value=14);""!==d&&
(b=d.length,d=d.substr(0,1).toUpperCase()+d.substr(1,b),document.getElementById("password").value=d);""!==h&&(h=h.substr(0,1).toUpperCase()+h.substr(1),document.getElementById("username").value=h);""!==g&&(g=g.substr(0,1).toUpperCase()+g.substr(1),document.getElementById("site_name").value=g);b="";f=zxcvbn(d,e);b=f.feedback.warning;console.log(f.guesses);console.log(b);b="Try adding a word or two, less common words are better. Or try adding a few numbers. "+b;document.getElementById("orig_score").innerHTML=
f.score;1>=f.score&&(e[0]==e[1]||e[0]==d||e[1]==d)?document.getElementById("feedback").innerHTML="Do not use your username or site name in the password! "+b:2>=f.score?(console.log("hit"),document.getElementById("feedback").innerHTML=b):document.getElementById("feedback").innerHTML="Score is 3 or above and thus suggestions not necessary";!1===p?(document.getElementById("orig_time").innerHTML=display_time(f.guesses/1300),k=2,l=6,m=16):document.getElementById("orig_time").innerHTML=display_time(f.guesses/
3600);b=Date.now();h=generate_salt(d,h,g,p);f=Date.now();scrypt(d,h,{logN:m,r:l,p:k,encoding:"hex"},function(a){d=a});k=Date.now();console.log("scrypt time:"+(k-f)+"ms");d=hex_decode(d);d=base32_encode(d);console.log("scrypt:"+d);d=simplify(d,c,n,p);document.getElementById("result").value=d;c=Date.now();n=c-b;console.log("total:"+(c-b)+"ms");!0===a&&alert("total new values:"+n);b=Date.now();f=zxcvbn(d,e);c=Date.now();console.log("zxcvbn:"+(c-b)+"ms");document.getElementById("gen_score").innerHTML=
f.score;document.getElementById("gen_time").innerHTML=display_time(f.guesses/9E3);modal_toggle("_progress");document.getElementById("generate_pass").disabled=!1}function percent_update(a){var b=document.getElementById("completed_perc"),c=document.getElementById("perc_text"),e=document.getElementById("perc_done");a+="%";c.innerHTML=a;e.innerHTML=a;b.style.width=a}
function modal_toggle(a){a=document.getElementById("modal"+a);a.style.visibility="visible"===a.style.visibility?"hidden":"visible";return 0}function no_spec_check(){!0===document.getElementById("no_spec").checked&&modal_toggle("_spec");return 0}function no_legacy_check(){!0===document.getElementById("no_legacy").checked&&modal_toggle("_legacy");return 0}function confirmed(a,b){document.getElementById("no"+b).checked=a;modal_toggle(b);return 0}
function generate_wrapper(a){a=void 0===a?!1:a;setTimeout(function(){document.getElementById("modal_progress").style.visibility="visible"},0);setTimeout(function(){document.getElementById("generate_pass").disabled=!0},1);setTimeout(function(){percent_update(70)},2);setTimeout(function(){generate_pass(a)},45)}
function score_password(){document.getElementById("no_legacy");var a,b=[];url=document.getElementById("site_name").value;password=document.getElementById("password").value;username=document.getElementById("username").value;max_len=document.getElementById("length").value;console.log("hits");""!==password&&(password=password.substr(0,1).toUpperCase()+password.substr(1),document.getElementById("password").value=password);""!==username&&(username=username.substr(0,1).toUpperCase()+username.substr(1),
document.getElementById("username").value=username);""!==url&&(url=url.substr(0,1).toUpperCase()+url.substr(1),document.getElementById("site_name").value=url);b[0]=username;b[1]=url;a=zxcvbn(password,b);var c="Try adding a word or two, less common words are better. Or try adding a few numbers. "+a.feedback.warning;document.getElementById("orig_score").innerHTML=a.score;1>=a.score&&(b[0]==b[1]||b[0]==password||b[1]==password)?document.getElementById("feedback").innerHTML="Do not use your username or site name in the password! "+
c:2>=a.score?(console.log("hit"),document.getElementById("feedback").innerHTML=c):document.getElementById("feedback").innerHTML="Score is 3 or above and thus suggestions not necessary";document.getElementById("orig_time").innerHTML=display_time(a.guesses/3E3)};function base32_encode(a){var b="",c=Math.floor(a.length/5),e=a.length%5,h,d,g,f,k,l,m,n="";0!=e&&(c+=1);for(i=0;i<c;i++)d=a.charCodeAt(5*i),f=a.charCodeAt(5*i+1),k=a.charCodeAt(5*i+2),l=a.charCodeAt(5*i+3),m=a.charCodeAt(5*i+4),h=d>>3,d=(d&7)<<2|f>>6,g=(f&63)>>1,f=(f&1)<<4|k>>4,k=(k&15)<<1|l>>7,parts6=(l&127)>>2,l=(l&3)<<3|m>>5,m&=31,b+="ybndrfg8ejkmcpqxot1uwisza345h769".charAt(h)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(d)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(g)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(f)+
"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(k)+"y"+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(l)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(m);a=0;1==e?a=6:2==e?a=4:3==e?a=3:4==e&&(a=1);e=8*i;for(i=0;i<a;i++)n+="=";return b=b.substr(0,e-a)+n}function hex_decode(a){var b=Math.ceil(a.length/2),c,e="";for(c=0;c<b;c++)e+=String.fromCharCode(parseInt(a.substr(2*c,2),16));return e}
function string_indexes(a,b){for(var c,e=0,h=[],d=0,g=0;null!==e;)c=a.substr(e),e=c.match(b),null!==e&&(h[g++]=c.indexOf(e[0])+d,d=e=c.indexOf(e[0])+1+d);return h}
function no_repeat_strings(a){for(var b="",c=a.length,e="",h=a.substr(0,1),d,g=1,f=1,k=0,l=0,m=0;1===g;)f>c&&1<=k&&100>=l?(m=m+f+l,f=1,a=b+e,a.substr(-1,1)===a.substr(-2,1)?(ins_place=m%c,a=a.substr(0,ins_place)+a.substr(-1,1)+a.substr(ins_place,c-1)):a.substr(0,1)===a.substr(1,1)&&(ins_place=m%c,a=a.substr(0,ins_place)+a.substr(-1,1)+a.substr(ins_place,c-1)),h=a.substr(0,1),k=0,g=1,b=e="",l+=1):f>c&&(g=0),d=a.substr(f,1),h==d?(b+=h,k=b.length):e+=h,h=d,f+=1;return a};function pow(a,b){return Math.pow(a,b)}function sqrt(a){return Math.sqrt(a)}function ceil(a){return Math.ceil(a)}function getint(a){return parseInt($(a).val())}function floor(a){return Math.floor(a)}function intval(a){return parseInt(a)}function rand(a,b){void 0===b&&(b=a,a=0);return Math.floor(Math.random()*(b-a))+a}function round(a,b){var c=0;void 0!==b&&(c=parseFloat(a.toFixed(b)));a=Math.round(a,5);return c!==a&&void 0!==b?parseFloat(c):parseInt(a)}
function randfloat(a,b,c){var e=Math.pow(10,c);a+=(b-a)*(rand(0,e)/e);return a=round(a,c)}function sum(a,b,c,e){for(var h;b<c;++b)h+=eval(e),++a}function mean(a){var b=a.length,c,e=0;for(c=0;c<b;++c)e+=a[c];return round(e/b,8)}function standard_deviation(a,b){var c=a.length,e,h=0;for(e=0;e<c;++e)h+=pow(a[e]-b,2);return h=round(sqrt(h/c),8)}function num_format(a){str=a+"";x=str.split(".");x1=x[0];x2=1<x.length?"."+x[1]:"";for(a=/(\d+)(\d{3})/;a.test(x1);)x1=x1.replace(a,"$1,$2");return x1+x2}
function float_bin(a){var b;b=a.split(".");var c=parseFloat("0."+b[1]),e=1;a=0;1<Math.abs(b[0])?(b=Math.abs(b[0]).toString(2),a=b.length,b+="."):b="0.";for(;0!==e&&24>a;)e=c*=2,e=Math.floor(e),b+=e,c+="",e=c.split("."),e=parseInt(e[1]),++a;c=b.split(".");a=0==parseInt(c[0])?c[0].length:c[1].length;for(c=0;c<a;++c);}function bin_float(a){}
function xor_rand(a,b){var c,e,h,d,g;c=window.screenX^window.screen.width;e=window.screenY^window.screen.height;h=Math.floor(4294967295*Math.rand());d=Math.floor(4294967295*Math.rand());d=(d^d<<1)>>3;d^=d<<10;c^=c<<16;h=c>>5^c<<1;e=(e^e>>2)<<5;e^=e>>15;var f=(d&6)+(c&6)+(e&6)+(h&6)+3,k;for(k=0;k<f;++k)d^=d<<1,d>>=3,d^=d<<10,h^=h<<1,c^=c<<16,h=c>>5,h^=c<<1,e^=e>>2,e<<=5,e^=e>>15;f*=2;for(k=0;k<f;++k)g=c^c<<20^e^e>>11^h^h<<27^d^d>>6,c=e,e=h,h=d,d=g;return a||b?Math.floor(d*(b-a))+a:d&4294967295}
function microtime(){return Date.now()/1E3}function display_time(a){var b;a=1>a?[null,"less than a second"]:60>a?(b=Math.round(a),[b,b+" second"]):3600>a?(b=Math.round(a/60),[b,b+" minute"]):86400>a?(b=Math.round(a/3600),[b,b+" hour"]):2678400>a?(b=Math.round(a/86400),[b,b+" day"]):32140800>a?(b=Math.round(a/2678400),[b,b+" month"]):321408E4>a?(b=Math.round(a/32140800),[b,b+" year"]):[null,"centuries"];b=a[0];a=a[1];null!=b&&1!==b&&(a+="s");return a};
