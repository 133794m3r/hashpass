perc=0;
function generate_salt(a,b,e,d,c){d=void 0===d?!1:d;c=void 0===c?!1:c;Date.now();var f=7,g=6,h=9,k=8;1==d&&!1===c?(a=scrypt(a,e,{log_n:f,r:g,p:1,encoding:"base64"}),b=scrypt(b,a,{log_n:f,r:g,p:1,encoding:"hex"}),e=scrypt(e,b,{log_n:f,r:g,p:1,encoding:"base64"})):(!0===c&&(f=g=9,h=12,k=14),g+=1,k+=1,a=ucrypt(a,e,{log_n:f,r:g,p:1,encoding:"base64"}),b=ucrypt(b,a,{log_n:f,r:g,p:1,encoding:"hex"}),e=ucrypt(e,b,{log_n:f,r:g,p:1,encoding:"base64"}));c=e+a+b;a=b+e+a;c=!0===d?scrypt(c,a,{log_n:h,r:k,p:1,
encoding:"hex"}):ucrypt(c,a,{log_n:h,r:k,p:1,encoding:"hex"});Date.now();return c}
function simplify(a,b,e,d){d=Date.now();var c=a.replace(/[^0-9]/g,""),f="";a=a.replace(/[^a-z]/g,"");var g=a.substr(1);var h=g=no_repeat_strings(g);g=a.substr(0,1).toUpperCase();var k=c.substr(0,1);c=c.substr(1);c=no_repeat_strings(c);var m=parseInt(c.substr(0,2))%3;var l=c.length;if(!1===e)switch(m){case 0:f="$";break;case 1:f="#";break;case 2:f="@"}else f=5<=l?c.substr(-1,1):h.substr(-1,1);num_str_len=round(b/2);b-num_str_len-1<=l&&(h=h.substr(0,num_str_len-2),c=c.substr(0,b-num_str_len-1));b-3-
(b-num_str_len-1)<=l?(h=h.substr(0,b-num_str_len-1),c=c.substr(0,num_str_len-2)):(total_len1=b-l,h=h.substr(0,total_len1-3),c.substr(0));switch((a.charCodeAt(1)+a.charCodeAt(1)+a.charCodeAt(2))%10){case 0:a=g+k+h+c+f;break;case 1:a=f+c+g+h+k;break;case 2:a=k+f+g+c+h;break;case 3:a=g+c+f+h+k;break;case 4:a=c+g+h+f+k;break;case 5:a=c+g+k+h+f;break;case 6:a=f+c+h+k+g;break;case 7:a=c+f+h+g+k;break;case 8:a=h+c+f+g+k;break;case 9:a=k+h+c+f+g}b=Date.now();console.log("pass "+a);console.log("pass_len "+
a.length);console.log("simplify:"+(b-d)+"ms");return a}
function generate_pass(a){a=void 0===a?!1:a;document.getElementsByTagName("input");var b=[],e=select_by_id("no_spec").checked,d=select_by_id("no_legacy").checked,c=select_by_id("no_security").checked;var f=select_by_id("site_name").value;var g=select_by_id("password").value;var h=select_by_id("username").value;var k=select_by_id("length").value;b[0]=h;b[1]=f;""===k&&(k=14,select_by_id("length").value=14);if(""!==g){var m=g.length;g=g.substr(0,1).toUpperCase()+g.substr(1,m);select_by_id("password").value=
g}""!==h&&(h=h.substr(0,1).toUpperCase()+h.substr(1),select_by_id("username").value=h);""!==f&&(f=f.substr(0,1).toUpperCase()+f.substr(1),select_by_id("site_name").value=f);var l=zxcvbn(g,b);m=l.feedback.warning;console.log(l.guesses);console.log(m);m="Try adding a word or two, less common words are better. Or try adding a few numbers. "+m;var n=l.score;if(0===n){color="red";var p="Unsafe";document.getElementById("orig_score_txt").setAttribute("style","color: red; font-weight:bold;")}else 1===n?(color=
"orange",p="Bad"):2===n?(color="yellow",p="Acceptable"):3===n?(color="yellowgreen",p="Safe"):(color="green",p="Perfect");select_by_id("orig_score_txt").setAttribute("style","color: white; font-weight:bold;");select_by_id("orig_score_txt").innerHTML=n;var q=23.75*n;select_by_id("low_score_warn").setAttribute("style","margin-left:29%; background-color:black; color:"+color);select_by_id("low_score_warn").innerHTML=p;select_by_id("orig_score_bar").setAttribute("style","width:"+q+"%; background-color:"+
color);1>=l.score&&(b[0]===b[1]||b[0]===g||b[1]===g)?select_by_id("feedback").innerHTML="Do not use your username or site name in the password! "+m:2>=l.score?select_by_id("feedback").innerHTML=m:select_by_id("feedback").innerHTML="Score is 3 or above and thus suggestions not necessary";b=Date.now();f=generate_salt(g,h,f,d);h=Date.now();!0===d?(select_by_id("orig_time").innerHTML=display_time(l.guesses/1300),g=scrypt(g,f,16,6,2,32,"binary")):!0===c?(select_by_id("orig_time").innerHTML=display_time(l.guesses/
1300),g=ucrypt(g,f,16,12,1,32,"binary"),select_by_id("length").value=14):(select_by_id("orig_time").innerHTML=display_time(l.guesses/1300),k++,g=ucrypt(g,f,17,14,1,32,"binary"));l=Date.now();console.log("scrypt time:"+(l-h)+"ms");g=base32_encode(g,!1);console.log("scrypt:"+g);g=simplify(g,k,e,d);select_by_id("result").value=g;k=Date.now();l=k-b;console.log("total:"+(k-b)+"ms");!0===a&&alert("total new values:"+l);b=Date.now();l=zxcvbn(g);k=Date.now();console.log("zxcvbn:"+(k-b)+"ms");n=l.score;console.log("b "+
n);color="green";q=23.75*n;select_by_id("gen_score_txt").innerHTML=n;select_by_id("gen_score_bar").setAttribute("style","width:"+q+"%; background-color:"+color);select_by_id("gen_time").innerHTML=display_time(l.guesses/9E3);modal_toggle("_progress");select_by_id("generate_pass").disabled=!1}function percent_update(a){var b=select_by_id("completed_perc"),e=select_by_id("perc_text"),d=select_by_id("perc_done");a+="%";e.innerHTML=a;d.innerHTML=a;b.style.width=a}
function modal_toggle(a){a=select_by_id("modal"+a);a.style.visibility="visible"===a.style.visibility?"hidden":"visible";return 0}function no_spec_check(){!0===select_by_id("no_spec").checked&&modal_toggle("_spec");return 0}function no_legacy_check(){!0===select_by_id("no_legacy").checked&&modal_toggle("_legacy");return 0}function change_security_mode(){!0===select_by_id("no_security").checked&&modal_toggle("_security");return 0}
function confirmed(a,b){select_by_id("no"+b).checked=a;modal_toggle(b);return 0}function generate_wrapper(a){a=void 0===a?!1:a;setTimeout(function(){select_by_id("modal_progress").style.visibility="visible"},0);setTimeout(function(){select_by_id("generate_pass").disabled=!0},1);setTimeout(function(){percent_update(70)},2);setTimeout(function(){generate_pass(a)},45)}
function score_password(){select_by_id("no_legacy");var a=select_by_id("site_name").value,b=select_by_id("password").value,e=select_by_id("username").value;select_by_id("length");var d=zxcvbn(b,[]);""!==b&&(b=b.substr(0,1).toUpperCase()+b.substr(1),select_by_id("password").value=b);""!==e&&(e=e.substr(0,1).toUpperCase()+e.substr(1),select_by_id("username").value=e);""!==a&&(a=a.substr(0,1).toUpperCase()+a.substr(1),select_by_id("site_name").value=a);var c=d.score;var f=d.feedback.warning;0===c?(color=
"red",c="Unsafe",select_by_id("orig_score_txt").setAttribute("style","color: red; font-weight:bold;")):1===c?(color="orange",c="Bad"):2===c?(color="yellow",c="Acceptable"):3===c?(color="yellowgreen",c="Safe"):(color="green",c="Perfect");select_by_id("orig_score_txt").setAttribute("style","color: white; font-weight:bold;");f="Try adding a word or two, less common words are better. Or try adding a few numbers. "+f;select_by_id("orig_score_txt").innerHTML=d.score;var g=23.75*d.score;select_by_id("orig_score_bar").setAttribute("style",
"width:"+g+"%; background-color:"+color);select_by_id("low_score_warn").setAttribute("style","margin-left:29%;color:"+color);select_by_id("low_score_warn").innerHTML=c;1>=d.score&&(e==b||a==b)?select_by_id("feedback").innerHTML="Do not use your username or site name in the password! "+f:2>=d.score?(console.log("hit"),select_by_id("feedback").innerHTML=f):select_by_id("feedback").innerHTML="Score is 3 or above and thus suggestions not necessary";select_by_id("orig_time").innerHTML=display_time(d.guesses/
3E3)};function permute(a){function b(){for(var b=[],d=0;d<e;d+=1)b.push(a[c[d]]);return b}var e=a.length,d=[],c=[];d.push(0);c.push(0);for(var f=1;f<e;f+=1)d.push(-1),c.push(f);var g="string"!==typeof a?b:function(){return b().join("")};return function(){var a;for(a=0;a<e;a+=1)if(0!==d[a]){var b=a;break}if(void 0!==b){for(a=b+1;a<e;a+=1)0!==d[a]&&c[a]>c[b]&&(b=a);var f=b+d[b];a=b;b=c[a];c[a]=c[f];c[f]=b;b=d[a];d[a]=d[f];d[f]=b;if(0===f||f===e-1||c[f+d[f]]>c[f])d[f]=0;for(a=0;a<e;a+=1)c[a]>c[f]&&(d[a]=a<
f?1:-1);return g()}}}function select_by_id(a){return document.getElementById(a)};function pow(a,b){return Math.pow(a,b)}function sqrt(a){return Math.sqrt(a)}function ceil(a){return Math.ceil(a)}function getint(a){return parseInt($(a).val())}function floor(a){return Math.floor(a)}function intval(a){return parseInt(a)}function rand(a,b){void 0===b&&(b=a,a=0);return Math.floor(Math.random()*(b-a))+a}function round(a,b){var e=0;void 0!==b&&(e=parseFloat(a.toFixed(b)));a=Math.round(a,5);return e!==a&&void 0!==b?parseFloat(e):parseInt(a)}
function mean(a){var b=a.length,e,d=0;for(e=0;e<b;++e)d+=a[e];return round(d/b,8)}function standard_deviation(a,b){var e=a.length,d,c=0;for(d=0;d<e;++d)c+=pow(a[d]-b,2);return c=round(sqrt(c/e),8)}function randfloat(a,b,e){var d=Math.pow(10,e);a+=(b-a)*(rand(0,d)/d);return a=round(a,e)}function sum(a,b,e,d){for(var c;b<e;++b)c+=eval(d),++a}function num_format(a){str=a+"";x=str.split(".");x1=x[0];x2=1<x.length?"."+x[1]:"";for(a=/(\d+)(\d{3})/;a.test(x1);)x1=x1.replace(a,"$1,$2");return x1+x2}
function float_bin(a){var b=a.split(".");var e=parseFloat("0."+b[1]),d=1;a=0;1<Math.abs(b[0])?(b=Math.abs(b[0]).toString(2),a=b.length,b+="."):b="0.";for(;0!==d&&24>a;)d=e*=2,d=Math.floor(d),b+=d,e+="",d=e.split("."),d=parseInt(d[1]),++a;e=b.split(".");a=0==parseInt(e[0])?e[0].length:e[1].length;for(e=0;e<a;++e);}function bin_float(a){}
function xor_rand(a,b){var e=window.screenX^window.screen.width;var d=window.screenY^window.screen.height;Math.rand();var c=Math.floor(4294967295*Math.rand());c=(c^c<<1)>>3;c^=c<<10;e^=e<<16;var f=e>>5^e<<1;d=(d^d>>2)<<5;d^=d>>15;var g=(c&6)+(e&6)+(d&6)+(f&6)+3,h;for(h=0;h<g;++h)c^=c<<1,c>>=3,c^=c<<10,e^=e<<16,f=e>>5,f^=e<<1,d^=d>>2,d<<=5,d^=d>>15;g*=2;for(h=0;h<g;++h){var k=e^e<<20^d^d>>11^f^f<<27^c^c>>6;e=d;d=f;f=c;c=k}return a||b?Math.floor(c*(b-a))+a:c&4294967295}
function microtime(){return Date.now()/1E3}function display_time(a){var b;a=1>a?[null,"less than a second"]:60>a?(b=Math.round(a),[b,b+" second"]):3600>a?(b=Math.round(a/60),[b,b+" minute"]):86400>a?(b=Math.round(a/3600),[b,b+" hour"]):2678400>a?(b=Math.round(a/86400),[b,b+" day"]):32140800>a?(b=Math.round(a/2678400),[b,b+" month"]):321408E4>a?(b=Math.round(a/32140800),[b,b+" year"]):[null,"centuries"];b=a[0];a=a[1];null!=b&&1!==b&&(a+="s");return a};function base32_encode_old(a){var b="",e=Math.floor(a.length/5),d=a.length%5,c="";0!=d&&(e+=1);for(i=0;i<e;i++){var f=a.charCodeAt(5*i);var g=a.charCodeAt(5*i+1);var h=a.charCodeAt(5*i+2);var k=a.charCodeAt(5*i+3);var m=a.charCodeAt(5*i+4);var l=f>>3;f=(f&7)<<2|g>>6;var n=(g&63)>>1;g=(g&1)<<4|h>>4;h=(h&15)<<1|k>>7;parts6=(k&127)>>2;k=(k&3)<<3|m>>5;m&=31;b+="ybndrfg8ejkmcpqxot1uwisza345h769".charAt(l)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(f)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(n)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(g)+
"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(h)+"y"+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(k)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(m)}a=0;1==d?a=6:2==d?a=4:3==d?a=3:4==d&&(a=1);d=8*i;for(i=0;i<a;i++)c+="=";return b=b.substr(0,d-a)+c}
function base32_encode(a,b){var e="",d=Math.floor(a.length/5),c=a.length%5,f="";0!=c&&(d+=1);if(!0===(void 0===b?!0:b))for(i=0;i<d;i++){i_5=5*i;var g=a.charCodeAt(i_5);var h=a.charCodeAt(i_5+1);var k=a.charCodeAt(i_5+2);var m=a.charCodeAt(i_5+3);var l=a.charCodeAt(i_5+4);b=g>>3;g=(g&7)<<2|h>>6;var n=(h&63)>>1;h=(h&1)<<4|k>>4;k=(k&15)<<1|m>>7;parts6=(m&127)>>2;m=(m&3)<<3|l>>5;l&=31;e+="ybndrfg8ejkmcpqxot1uwisza345h769".charAt(b)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(g)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(n)+
"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(h)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(k)+"y"+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(m)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(l)}else for(i=0;i<d;i++)i_5=5*i,g=a[i_5],h=a[i_5+1],k=a[i_5+2],m=a[i_5+3],l=a[i_5+4],b=g>>3,g=(g&7)<<2|h>>6,n=(h&63)>>1,h=(h&1)<<4|k>>4,k=(k&15)<<1|m>>7,parts6=(m&127)>>2,m=(m&3)<<3|l>>5,l&=31,e+="ybndrfg8ejkmcpqxot1uwisza345h769".charAt(b)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(g)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(n)+
"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(h)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(k)+"y"+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(m)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(l);a=0;1==c?a=6:2==c?a=4:3==c?a=3:4==c&&(a=1);c=8*i;for(i=0;i<a;i++)f+="=";return e=e.substr(0,c-a)+f}function hex_decode(a){var b=Math.ceil(a.length/2),e,d="";for(e=0;e<b;e++)d+=String.fromCharCode(parseInt(a.substr(2*e,2),16));return d}
function string_indexes(a,b){for(var e,d=0,c=[],f=0,g=0;null!==d;)e=a.substr(d),d=e.match(b),null!==d&&(c[g++]=e.indexOf(d[0])+f,f=d=e.indexOf(d[0])+1+f);return c}
function no_repeat_strings(a){for(var b="",e=a.length,d="",c=a.substr(0,1),f,g=1,h=1,k=0,m=0,l=0;1===g;)h>e&&1<=k&&100>=m?(l=l+h+m,h=1,a=b+d,a.substr(-1,1)===a.substr(-2,1)?(ins_place=l%e,a=a.substr(0,ins_place)+a.substr(-1,1)+a.substr(ins_place,e-1)):a.substr(0,1)===a.substr(1,1)&&(ins_place=l%e,a=a.substr(0,ins_place)+a.substr(-1,1)+a.substr(ins_place,e-1)),c=a.substr(0,1),k=0,g=1,b=d="",m+=1):h>e&&(g=0),f=a.substr(h,1),c==f?(b+=c,k=b.length):d+=c,c=f,h+=1;return a}
function b64_encode(a,b){var e,d="",c=[],f=0,g=e=0,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".split("");if(0==(void 0===b?!1:b))for(;b=a.charCodeAt(e++);)128>b?c[g]=b:(2048>b?c[g]=192|b>>6:(65536>b?c[g]=224|b>>12:(c[g]=240|b>>18,c[g]=128|b>>12&63),c[g]=128|b>>6&63),c[g]=128|b&63),++g;else c=a,g=c.length;for(console.log(c);f<g;)a=c[f++],e=c[f++],b=c[f++],d+=h[a>>2],d+=h[(a&3)<<4|e>>4],d+=h[void 0===e?64:(e&15)<<2|b>>6],d+=h[void 0===b?64:b&63];return d}
function b64_decode(a){for(var b,e,d,c,f=0,g=a.length,h=[],k;f<g;)b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(f)),e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(f+1)),d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(f+2,1),c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(f+3,1),b=b<<2|e>>4,e=(e&15)<<4|d>>2,k=(d&3)<<6|chr4,h+=String.fromCharCode(b),64!==d?h+=
String.fromCharCode(e):64!==c&&(h+=String.fromCharCode(k)),++f;return h=unescape(h)};
