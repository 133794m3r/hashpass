/*
* Awesome Password Generator aka HashPass
* Copyright (c) Macarthur Inbody 2011-2017
* https://github.com/133794m3r/hashpass
* Licensed AGPLv3 or Later
* version 2.0.1
*/
function pow(a,b){return Math.pow(a,b)}function sqrt(a){return Math.sqrt(a)}function ceil(a){return Math.ceil(a)}function getint(a){return parseInt($(a).val())}function floor(a){return Math.floor(a)}function intval(a){return parseInt(a)}function rand(a,b){void 0===b&&(b=a,a=0);return Math.floor(Math.random()*(b-a))+a}function round(a,b){var c=0;void 0!==b&&(c=parseFloat(a.toFixed(b)));a=Math.round(a,5);return c!==a&&void 0!==b?parseFloat(c):parseInt(a)}
function mean(a){var b=a.length,c,e=0;for(c=0;c<b;++c)e+=a[c];return round(e/b,8)}function standard_deviation(a,b){var c=a.length,e,d=0;for(e=0;e<c;++e)d+=pow(a[e]-b,2);return d=round(sqrt(d/c),8)}function randfloat(a,b,c){var e=Math.pow(10,c);a+=(b-a)*(rand(0,e)/e);return a=round(a,c)}function sum(a,b,c,e){for(var d;b<c;++b)d+=eval(e),++a}function num_format(a){str=a+"";x=str.split(".");x1=x[0];x2=1<x.length?"."+x[1]:"";for(a=/(\d+)(\d{3})/;a.test(x1);)x1=x1.replace(a,"$1,$2");return x1+x2}
function float_bin(a){var b=a.split(".");var c=parseFloat("0."+b[1]),e=1;a=0;1<Math.abs(b[0])?(b=Math.abs(b[0]).toString(2),a=b.length,b+="."):b="0.";for(;0!==e&&24>a;)e=c*=2,e=Math.floor(e),b+=e,c+="",e=c.split("."),e=parseInt(e[1]),++a;c=b.split(".");a=0==parseInt(c[0])?c[0].length:c[1].length;for(c=0;c<a;++c);}function bin_float(a){}
function xor_rand(a,b){var c=window.screenX^window.screen.width;var e=window.screenY^window.screen.height;Math.rand();var d=Math.floor(4294967295*Math.rand());d=(d^d<<1)>>3;d^=d<<10;c^=c<<16;var f=c>>5^c<<1;e=(e^e>>2)<<5;e^=e>>15;var g=(d&6)+(c&6)+(e&6)+(f&6)+3,h;for(h=0;h<g;++h)d^=d<<1,d>>=3,d^=d<<10,c^=c<<16,f=c>>5,f^=c<<1,e^=e>>2,e<<=5,e^=e>>15;g*=2;for(h=0;h<g;++h){var k=c^c<<20^e^e>>11^f^f<<27^d^d>>6;c=e;e=f;f=d;d=k}return a||b?Math.floor(d*(b-a))+a:d&4294967295}
function microtime(){return Date.now()/1E3}function display_time(a){var b;a=1>a?[null,"less than a second"]:60>a?(b=Math.round(a),[b,b+" second"]):3600>a?(b=Math.round(a/60),[b,b+" minute"]):86400>a?(b=Math.round(a/3600),[b,b+" hour"]):2678400>a?(b=Math.round(a/86400),[b,b+" day"]):32140800>a?(b=Math.round(a/2678400),[b,b+" month"]):321408E4>a?(b=Math.round(a/32140800),[b,b+" year"]):[null,"centuries"];b=a[0];a=a[1];null!=b&&1!==b&&(a+="s");return a};function base32_encode(a){var b="",c=Math.floor(a.length/5),e=a.length%5,d="";0!=e&&(c+=1);for(i=0;i<c;i++){var f=a.charCodeAt(5*i);var g=a.charCodeAt(5*i+1);var h=a.charCodeAt(5*i+2);var k=a.charCodeAt(5*i+3);var l=a.charCodeAt(5*i+4);var m=f>>3;f=(f&7)<<2|g>>6;var n=(g&63)>>1;g=(g&1)<<4|h>>4;h=(h&15)<<1|k>>7;parts6=(k&127)>>2;k=(k&3)<<3|l>>5;l&=31;b+="ybndrfg8ejkmcpqxot1uwisza345h769".charAt(m)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(f)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(n)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(g)+
"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(h)+"y"+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(k)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(l)}a=0;1==e?a=6:2==e?a=4:3==e?a=3:4==e&&(a=1);e=8*i;for(i=0;i<a;i++)d+="=";return b=b.substr(0,e-a)+d}function hex_decode(a){var b=Math.ceil(a.length/2),c,e="";for(c=0;c<b;c++)e+=String.fromCharCode(parseInt(a.substr(2*c,2),16));return e}
function string_indexes(a,b){for(var c,e=0,d=[],f=0,g=0;null!==e;)c=a.substr(e),e=c.match(b),null!==e&&(d[g++]=c.indexOf(e[0])+f,f=e=c.indexOf(e[0])+1+f);return d}
function no_repeat_strings(a){for(var b="",c=a.length,e="",d=a.substr(0,1),f,g=1,h=1,k=0,l=0,m=0;1===g;)h>c&&1<=k&&100>=l?(m=m+h+l,h=1,a=b+e,a.substr(-1,1)===a.substr(-2,1)?(ins_place=m%c,a=a.substr(0,ins_place)+a.substr(-1,1)+a.substr(ins_place,c-1)):a.substr(0,1)===a.substr(1,1)&&(ins_place=m%c,a=a.substr(0,ins_place)+a.substr(-1,1)+a.substr(ins_place,c-1)),d=a.substr(0,1),k=0,g=1,b=e="",l+=1):h>c&&(g=0),f=a.substr(h,1),d==f?(b+=d,k=b.length):e+=d,d=f,h+=1;return a}
function b64_encode(a,b){var c,e="",d=[],f=0,g=c=0,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".split("");if(0==(void 0===b?!1:b))for(;b=a.charCodeAt(c++);)128>b?d[g]=b:(2048>b?d[g]=192|b>>6:(65536>b?d[g]=224|b>>12:(d[g]=240|b>>18,d[g]=128|b>>12&63),d[g]=128|b>>6&63),d[g]=128|b&63),++g;else d=a,g=d.length;for(console.log(d);f<g;)a=d[f++],c=d[f++],b=d[f++],e+=h[a>>2],e+=h[(a&3)<<4|c>>4],e+=h[void 0===c?64:(c&15)<<2|b>>6],e+=h[void 0===b?64:b&63];return e}
function b64_decode(a){for(var b,c,e,d,f=0,g=a.length,h=[],k;f<g;)b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(f)),c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(f+1)),e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(f+2,1),d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(f+3,1),b=b<<2|c>>4,c=(c&15)<<4|e>>2,k=(e&3)<<6|chr4,h+=String.fromCharCode(b),64!==e?h+=
String.fromCharCode(c):64!==d&&(h+=String.fromCharCode(k)),++f;return h=unescape(h)};perc=0;
function generate_salt(a,b,c,e){e=void 0===e?!1:e;var d=Date.now(),f=8;var g=6;1==e?(a=scrypt(a,c,{log_n:7,r:g,p:1,encoding:"base64"}),b=scrypt(b,a,{log_n:7,r:g,p:1,encoding:"hex"}),c=scrypt(c,b,{log_n:7,r:g,p:1,encoding:"base64"})):(g+=1,f+=1,a=ucrypt(a,c,{log_n:7,r:g,p:1,encoding:"base64"}),b=ucrypt(b,a,{log_n:7,r:g,p:1,encoding:"hex"}),c=ucrypt(c,b,{log_n:7,r:g,p:1,encoding:"base64"}));g=c+a+b;salt2=b+c+a;g=!0===e?scrypt(g,salt2,{log_n:9,r:f,p:1,encoding:"hex"}):ucrypt(g,salt2,{log_n:9,r:f,p:1,
encoding:"hex"});a=Date.now();console.log("gen_salt:"+(a-d)+"ms");console.log(g);return g}function generate_salt_argon2(a,b,c){a=Date.now();b=Date.now();console.log("gen_salt:"+(b-a)+"ms");console.log(salt);return salt}
function simplify(a,b,c,e){e=Date.now();var d=a.replace(/[^0-9]/g,""),f="";a=a.replace(/[^a-z]/g,"");console.log(a);var g=a.substr(1);var h=g=no_repeat_strings(g);g=a.substr(0,1).toUpperCase();var k=d.substr(0,1);d=d.substr(1);d=no_repeat_strings(d);var l=parseInt(d.substr(0,2))%3;if(!1===c)switch(l){case 0:f="$";break;case 1:f="#";break;case 2:f="@"}else f=5<=d.length?d.substr(-1,1):h.substr(-1,1);5<=d.length?(num_str_len=Math.floor(b/2),h=h.substr(0,num_str_len-2),d=d.substr(0,b-num_str_len-1)):
(b-=d.length,h=h.substr(0,b-3),d.substr(0));switch((a.charCodeAt(1)+a.charCodeAt(1)+a.charCodeAt(2))%10){case 0:a=g+k+h+d+f;break;case 1:a=f+d+g+h+k;break;case 2:a=k+f+g+d+h;break;case 3:a=g+d+f+h+k;break;case 4:a=d+g+h+f+k;break;case 5:a=d+g+k+h+f;break;case 6:a=f+d+h+k+g;break;case 7:a=d+f+h+g+k;break;case 8:a=h+d+f+g+k;break;case 9:a=k+h+d+f+g}b=Date.now();console.log("pass "+a);console.log("simplify:"+(b-e)+"ms");return a}
function generate_pass(a){a=void 0===a?!1:a;document.getElementsByTagName("input");var b=[],c=document.getElementById("no_spec").checked,e=document.getElementById("no_legacy").checked;var d=document.getElementById("site_name").value;var f=document.getElementById("password").value;var g=document.getElementById("username").value;var h=document.getElementById("length").value;b[0]=g;b[1]=d;""===h&&(h=14,document.getElementById("length").value=14);if(""!==f){var k=f.length;f=f.substr(0,1).toUpperCase()+
f.substr(1,k);document.getElementById("password").value=f}""!==g&&(g=g.substr(0,1).toUpperCase()+g.substr(1),document.getElementById("username").value=g);""!==d&&(d=d.substr(0,1).toUpperCase()+d.substr(1),document.getElementById("site_name").value=d);var l=zxcvbn(f,b);k=l.feedback.warning;console.log(l.guesses);console.log(k);k="Try adding a word or two, less common words are better. Or try adding a few numbers. "+k;document.getElementById("orig_score").innerHTML=l.score;1>=l.score&&(b[0]==b[1]||
b[0]==f||b[1]==f)?document.getElementById("feedback").innerHTML="Do not use your username or site name in the password! "+k:2>=l.score?(console.log("hit"),document.getElementById("feedback").innerHTML=k):document.getElementById("feedback").innerHTML="Score is 3 or above and thus suggestions not necessary";k=Date.now();d=generate_salt(f,g,d,e);g=Date.now();!0===e?(document.getElementById("orig_time").innerHTML=display_time(l.guesses/1300),f=scrypt(f,d,16,6,2,32,"hex")):(document.getElementById("orig_time").innerHTML=
display_time(l.guesses/1300),f=ucrypt(f,d,16,12,1,32,"hex"));l=Date.now();console.log("scrypt time:"+(l-g)+"ms");f=hex_decode(f);f=base32_encode(f);console.log("scrypt:"+f);f=simplify(f,h,c,e);document.getElementById("result").value=f;h=Date.now();l=h-k;console.log("total:"+(h-k)+"ms");!0===a&&alert("total new values:"+l);k=Date.now();l=zxcvbn(f,b);h=Date.now();console.log("zxcvblog_n:"+(h-k)+"ms");document.getElementById("gen_score").innerHTML=l.score;document.getElementById("gen_time").innerHTML=
display_time(l.guesses/9E3);modal_toggle("_progress");document.getElementById("generate_pass").disabled=!1}function percent_update(a){var b=document.getElementById("completed_perc"),c=document.getElementById("perc_text"),e=document.getElementById("perc_done");a+="%";c.innerHTML=a;e.innerHTML=a;b.style.width=a}function modal_toggle(a){a=document.getElementById("modal"+a);a.style.visibility="visible"===a.style.visibility?"hidden":"visible";return 0}
function no_spec_check(){!0===document.getElementById("no_spec").checked&&modal_toggle("_spec");return 0}function no_legacy_check(){!0===document.getElementById("no_legacy").checked&&modal_toggle("_legacy");return 0}function confirmed(a,b){document.getElementById("no"+b).checked=a;modal_toggle(b);return 0}
function generate_wrapper(a){a=void 0===a?!1:a;setTimeout(function(){document.getElementById("modal_progress").style.visibility="visible"},0);setTimeout(function(){document.getElementById("generate_pass").disabled=!0},1);setTimeout(function(){percent_update(70)},2);setTimeout(function(){generate_pass(a)},45)}
function score_password(){document.getElementById("no_legacy");var a=[];url=document.getElementById("site_name").value;password=document.getElementById("password").value;username=document.getElementById("username").value;max_len=document.getElementById("length").value;a[0]=username;a[1]=url;var b=zxcvbn(password,a);console.log("hits");""!==password&&(password=password.substr(0,1).toUpperCase()+password.substr(1),document.getElementById("password").value=password);""!==username&&(username=username.substr(0,
1).toUpperCase()+username.substr(1),document.getElementById("username").value=username);""!==url&&(url=url.substr(0,1).toUpperCase()+url.substr(1),document.getElementById("site_name").value=url);a[0]=username;a[1]=url;var c="Try adding a word or two, less common words are better. Or try adding a few numbers. "+b.feedback.warning;document.getElementById("orig_score").innerHTML=b.score;1>=b.score&&(a[0]==a[1]||a[0]==password||a[1]==password)?document.getElementById("feedback").innerHTML="Do not use your username or site name in the password! "+
c:2>=b.score?(console.log("hit"),document.getElementById("feedback").innerHTML=c):document.getElementById("feedback").innerHTML="Score is 3 or above and thus suggestions not necessary";document.getElementById("orig_time").innerHTML=display_time(b.guesses/3E3)};
