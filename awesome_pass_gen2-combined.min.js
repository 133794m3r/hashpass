/*
* Awesome Password Generator aka HashPass
* Copyright (c) Macarthur Inbody 2011-2017
* https://github.com/133794m3r/hashpass
* AGPLv3
*/
perc=0;function generate_salt(a,d,b){var c=Date.now(),f="";scrypt(a,b,{logN:7,r:6,p:1,encoding:"base64"},function(b){a=b});scrypt(d,a,{logN:7,r:6,p:1,encoding:"hex"},function(a){d=a});scrypt(b,d,{logN:7,r:6,p:1,encoding:"base64"},function(a){b=a});f=b+a+d;salt2=d+b+a;scrypt(f,salt2,{logN:9,r:8,p:1,encoding:"hex"},function(a){f=a});var e=Date.now();console.log("gen_salt:"+(e-c)+"ms");console.log(f);return f}
function simplify(a,d,b){var c=Date.now(),f=RegExp("[^a-z]","g"),e=a.replace(RegExp("[^0-9]","g"),""),g,h,k,l="";k=(a.charCodeAt(1)+a.charCodeAt(1)+a.charCodeAt(2))%3;a=a.replace(f,"");console.log(a);var m,f=a.substr(1);g=f=no_repeat_strings(f);f=a.substr(0,1).toUpperCase();h=e.substr(0,1);e=e.substr(1);e=no_repeat_strings(e);m=parseInt(e.substr(0,2))%3;if(!1===b)switch(m){case 0:l="$";break;case 1:l="#";break;case 2:l="@"}else l=5<=e.length?e.substr(-1,1):g.substr(-1,1);5<=e.length?(num_str_len=
Math.floor(d/2),g=g.substr(0,num_str_len-2),e=e.substr(0,d-num_str_len-1)):(d-=e.length,g=g.substr(0,d-3),e.substr(0));switch(k){case 0:a=h+f+g+e+l;break;case 1:a=f+h+g+e+l;break;case 2:a=h+f+e+g+l}d=Date.now();console.log("simplify:"+(d-c)+"ms");return a}
function generate_pass(){document.getElementsByTagName("input");var a=14,d="",b="",c="",f="",e=a=d=0,f=0,g=document.getElementById("no_spec").checked,c=document.getElementById("site_name").value,b=document.getElementById("password").value,d=document.getElementById("username").value,a=document.getElementById("length").value;""===a&&(a=14,document.getElementById("length").value=14);f=zxcvbn(b);document.getElementById("orig_score").innerHTML=f.score;document.getElementById("feedback").innerHTML=f.feedback.suggestions;
document.getElementById("orig_time").innerHTML=f.crack_times_display.offline_slow_hashing_1e4_per_second;e=Date.now();d=generate_salt(b,d,c);f=Date.now();scrypt(b,d,{logN:15,r:10,p:1,encoding:"hex"},function(a){b=a});d=Date.now();console.log("scrypt time:"+(d-f)+"ms");b=hex_decode(b);b=base32_encode(b);console.log("scrypt:"+b);b=simplify(b,a,g);b=b.substr(0,a);document.getElementById("result").value=b;a=Date.now();g=a-e;console.log("total:"+(a-e)+"ms");e=Date.now();f=zxcvbn(b);a=Date.now();console.log("zxcvbn:"+
(a-e)+"ms");document.getElementById("gen_score").innerHTML=f.score;document.getElementById("gen_time").innerHTML=f.crack_times_display.offline_slow_hashing_1e4_per_second;console.log(JSON.stringify(f.crack_times_display.offline_slow_hashing_1e4_per_second));modal_toggle("_progress");perc=0;}
function percent_update(a){var d=document.getElementById("completed_perc"),b=document.getElementById("perc_text"),c=document.getElementById("perc_done");a+="%";b.innerHTML=a;c.innerHTML=a;d.style.width=a}function modal_toggle(a){a=document.getElementById("modal"+a);a.style.visibility="visible"===a.style.visibility?"hidden":"visible"}function no_spec_check(){!0===document.getElementById("no_spec").checked&&modal_toggle("_spec")}
function confirmed(a){document.getElementById("no_spec").checked=a;modal_toggle("_spec")}function generate_wrapper(){setTimeout(function(){document.getElementById("modal_progress").style.visibility="visible"},0);setTimeout(function(){percent_update(70)},1);setTimeout(function(){generate_pass()},30)};function base32_encode(a){var d="",b=Math.floor(a.length/5),c=a.length%5,f,e,g,h,k,l,m,n="";0!=c&&(b+=1);for(i=0;i<b;i++)e=a.charCodeAt(5*i),h=a.charCodeAt(5*i+1),k=a.charCodeAt(5*i+2),l=a.charCodeAt(5*i+3),m=a.charCodeAt(5*i+4),f=e>>3,e=(e&7)<<2|h>>6,g=(h&63)>>1,h=(h&1)<<4|k>>4,k=(k&15)<<1|l>>7,parts6=(l&127)>>2,l=(l&3)<<3|m>>5,m&=31,d+="ybndrfg8ejkmcpqxot1uwisza345h769".charAt(f)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(e)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(g)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(h)+
"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(k)+"y"+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(l)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(m);a=0;1==c?a=6:2==c?a=4:3==c?a=3:4==c&&(a=1);c=8*i;for(i=0;i<a;i++)n+="=";return d=d.substr(0,c-a)+n}function hex_decode(a){var d=Math.ceil(a.length/2),b,c="";for(b=0;b<d;b++)c+=String.fromCharCode(parseInt(a.substr(2*b,2),16));return c}
function string_indexes(a,d){for(var b,c=0,f=[],e=0,g=0;null!==c;)b=a.substr(c),c=b.match(d),null!==c&&(f[g++]=b.indexOf(c[0])+e,e=c=b.indexOf(c[0])+1+e);return f}
function no_repeat_strings(a){for(var d="",b=a.length,c="",f=a.substr(0,1),e,g=1,h=1,k=0,l=0,m=0;1===g;)h>b&&1<=k&&100>=l?(m=m+h+l,h=1,a=d+c,a.substr(-1,1)===a.substr(-2,1)?(ins_place=m%b,a=a.substr(0,ins_place)+a.substr(-1,1)+a.substr(ins_place,b-1)):a.substr(0,1)===a.substr(1,1)&&(ins_place=m%b,a=a.substr(0,ins_place)+a.substr(-1,1)+a.substr(ins_place,b-1)),f=a.substr(0,1),k=0,g=1,d=c="",l+=1):h>b&&(g=0),e=a.substr(h,1),f==e?(d+=f,k=d.length):c+=f,f=e,h+=1;return a};function pow(a,d){return Math.pow(a,d)}function sqrt(a){return Math.sqrt(a)}function ceil(a){return Math.ceil(a)}function getint(a){return parseInt($(a).val())}function floor(a){return Math.floor(a)}function intval(a){return parseInt(a)}function rand(a,d){void 0===d&&(d=a,a=0);return Math.floor(Math.random()*(d-a))+a}function round(a,d){var b=0;void 0!==d&&(b=parseFloat(a.toFixed(d)));a=Math.round(a,5);return b!==a&&void 0!==d?parseFloat(b):parseInt(a)}
function randfloat(a,d,b){var c=Math.pow(10,b);a+=(d-a)*(rand(0,c)/c);return a=round(a,b)}function sum(a,d,b,c){for(var f;d<b;++d)f+=eval(c),++a}function mean(a){var d=a.length,b,c=0;for(b=0;b<d;++b)c+=a[b];return round(c/d,8)}function standard_deviation(a,d){var b=a.length,c,f=0;for(c=0;c<b;++c)f+=pow(a[c]-d,2);return f=round(sqrt(f/b),8)}function num_format(a){str=a+"";x=str.split(".");x1=x[0];x2=1<x.length?"."+x[1]:"";for(a=/(\d+)(\d{3})/;a.test(x1);)x1=x1.replace(a,"$1,$2");return x1+x2}
function float_bin(a){var d;d=a.split(".");var b=parseFloat("0."+d[1]),c=1;a=0;1<Math.abs(d[0])?(d=Math.abs(d[0]).toString(2),a=d.length,d+="."):d="0.";for(;0!==c&&24>a;)c=b*=2,c=Math.floor(c),d+=c,b+="",c=b.split("."),c=parseInt(c[1]),++a;b=d.split(".");a=0==parseInt(b[0])?b[0].length:b[1].length;for(b=0;b<a;++b);}function bin_float(a){}
function xor_rand(a,d){var b,c,f,e,g;b=window.screenX^window.screen.width;c=window.screenY^window.screen.height;f=Math.floor(4294967295*Math.rand());e=Math.floor(4294967295*Math.rand());e=(e^e<<1)>>3;e^=e<<10;b^=b<<16;f=b>>5^b<<1;c=(c^c>>2)<<5;c^=c>>15;var h=(e&6)+(b&6)+(c&6)+(f&6)+3,k;for(k=0;k<h;++k)e^=e<<1,e>>=3,e^=e<<10,f^=f<<1,b^=b<<16,f=b>>5,f^=b<<1,c^=c>>2,c<<=5,c^=c>>15;h*=2;for(k=0;k<h;++k)g=b^b<<20^c^c>>11^f^f<<27^e^e>>6,b=c,c=f,f=e,e=g;return a||d?Math.floor(e*(d-a))+a:e&4294967295}
function microtime(){return Date.now()/1E3};
