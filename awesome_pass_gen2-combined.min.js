perc=0;function generate_salt(a,b,c,d){d=void 0===d?!1:d;var g=Date.now(),e="",f=7,h=1,l=8,k=9,m=1,n=6;!1===d&&(f=9,h=4,k=13,n=l=8,m=3);scrypt(a,c,{logN:f,r:n,p:h,encoding:"base64"},function(b){a=b});scrypt(b,a,{logN:f,r:n,p:h,encoding:"hex"},function(a){b=a});scrypt(c,b,{logN:f,r:n,p:h,encoding:"base64"},function(a){c=a});e=c+a+b;salt2=b+c+a;scrypt(e,salt2,{logN:k,r:l,p:m,encoding:"hex"},function(a){e=a});d=Date.now();console.log("gen_salt:"+(d-g)+"ms");console.log(e);return e}
function simplify(a,b,c,d){var g=Date.now(),e=RegExp("[^a-z]","g"),f=a.replace(RegExp("[^0-9]","g"),""),h,l,k="";a=a.replace(e,"");console.log(a);var m,e=a.substr(1);h=e=no_repeat_strings(e);e=a.substr(0,1).toUpperCase();l=f.substr(0,1);f=f.substr(1);f=no_repeat_strings(f);m=parseInt(f.substr(0,2))%3;if(!1===c)switch(m){case 0:k="$";break;case 1:k="#";break;case 2:k="@"}else k=5<=f.length?f.substr(-1,1):h.substr(-1,1);5<=f.length?(num_str_len=Math.floor(b/2),h=h.substr(0,num_str_len-2),f=f.substr(0,
b-num_str_len-1)):(b-=f.length,h=h.substr(0,b-3),f.substr(0));if(!0===d)switch(b=(a.charCodeAt(1)+a.charCodeAt(1)+a.charCodeAt(2))%5,b){case 0:a=l+e+h+f+k;break;case 1:a=e+l+h+f+k;break;case 2:a=l+e+f+h+k;break;case 3:a=f+e+h+l+k;break;case 4:a=f+e+l+h+k}else switch(b=(a.charCodeAt(1)+a.charCodeAt(1)+a.charCodeAt(2))%10,b){case 0:a=e+l+h+f+k;break;case 1:a=k+f+e+h+l;break;case 2:a=l+k+e+f+h;break;case 3:a=e+f+k+h+l;break;case 4:a=f+e+h+k+l;break;case 5:a=f+e+l+h+k;break;case 6:a=k+f+h+l+e;break;case 7:a=
f+k+h+e+l;break;case 8:passwod=h+f+k+e+l;break;case 9:a=l+h+f+k+e}k=Date.now();console.log("simplify:"+(k-g)+"ms");return a}
function generate_pass(a){document.getElementsByTagName("input");var b="",c=14;a=[];var d="",g="",e="",f="",h=0,f=b=c=0,b=b="",h=1,l=document.getElementById("no_spec").checked,k=document.getElementById("no_legacy").checked,e=document.getElementById("site_name").value,g=document.getElementById("password").value,d=document.getElementById("username").value,c=document.getElementById("length").value;a[0]=d;a[1]=e;""===c&&(c=14,document.getElementById("length").value=14);""!==g&&(b=g.length,g=g.substr(0,
1).toUpperCase()+g.substr(1,b),document.getElementById("password").value=g);""!==d&&(d=d.substr(0,1).toUpperCase()+d.substr(1),document.getElementById("username").value=d);""!==e&&(e=e.substr(0,1).toUpperCase()+e.substr(1),document.getElementById("site_name").value=e);b="";f=zxcvbn(g,a);b=f.feedback.warning;console.log(f.guesses);console.log(b);b="Try adding a word or two, less common words are better. Or try adding a few numbers. "+b;document.getElementById("orig_score").innerHTML=f.score;1>=f.score&&
(a[0]==a[1]||a[0]==g||a[1]==g)?document.getElementById("feedback").innerHTML="Do not use your username or site name in the password! "+b:2>=f.score?(console.log("hit"),document.getElementById("feedback").innerHTML=b):document.getElementById("feedback").innerHTML="Score is 3 or above and thus suggestions not necessary";!1===k?(document.getElementById("orig_time").innerHTML=display_time(f.guesses/1700),h=2):document.getElementById("orig_time").innerHTML=display_time(f.guesses/3600);b=Date.now();d=generate_salt(g,
d,e,k);f=Date.now();scrypt(g,d,{logN:15,r:10,p:h,encoding:"hex"},function(a){g=a});h=Date.now();console.log("scrypt time:"+(h-f)+"ms");g=hex_decode(g);g=base32_encode(g);console.log("scrypt:"+g);g=simplify(g,c,l,k);document.getElementById("result").value=g;c=Date.now();console.log("total:"+(c-b)+"ms");b=Date.now();f=zxcvbn(g,a);c=Date.now();console.log("zxcvbn:"+(c-b)+"ms");document.getElementById("gen_score").innerHTML=f.score;document.getElementById("gen_time").innerHTML=display_time(f.guesses/
7500);modal_toggle("_progress");perc=0}function percent_update(a){var b=document.getElementById("completed_perc"),c=document.getElementById("perc_text"),d=document.getElementById("perc_done");a+="%";c.innerHTML=a;d.innerHTML=a;b.style.width=a}function modal_toggle(a){a=document.getElementById("modal"+a);a.style.visibility="visible"===a.style.visibility?"hidden":"visible";return 0}function no_spec_check(){!0===document.getElementById("no_spec").checked&&modal_toggle("_spec");return 0}
function no_legacy_check(){!0===document.getElementById("no_legacy").checked&&modal_toggle("_legacy");return 0}function confirmed(a,b){document.getElementById("no"+b).checked=a;modal_toggle(b);return 0}function generate_wrapper(a){a=void 0===a?!1:a;setTimeout(function(){document.getElementById("modal_progress").style.visibility="visible"},0);setTimeout(function(){percent_update(70)},1);setTimeout(function(){generate_pass(a)},45)}
function score_password(){var a=document.getElementById("no_legacy").checked,b,c=[];url=document.getElementById("site_name").value;password=document.getElementById("password").value;username=document.getElementById("username").value;max_len=document.getElementById("length").value;console.log("hits");""!==password&&(password=password.substr(0,1).toUpperCase()+password.substr(1),document.getElementById("password").value=password);""!==username&&(username=username.substr(0,1).toUpperCase()+username.substr(1),
document.getElementById("username").value=username);""!==url&&(url=url.substr(0,1).toUpperCase()+url.substr(1),document.getElementById("site_name").value=url);c[0]=username;c[1]=url;b=zxcvbn(password,c);var d="Try adding a word or two, less common words are better. Or try adding a few numbers. "+b.feedback.warning;document.getElementById("orig_score").innerHTML=b.score;1>=b.score&&(c[0]==c[1]||c[0]==password||c[1]==password)?document.getElementById("feedback").innerHTML="Do not use your username or site name in the password! "+
d:2>=b.score?(console.log("hit"),document.getElementById("feedback").innerHTML=d):document.getElementById("feedback").innerHTML="Score is 3 or above and thus suggestions not necessary";!1===a?document.getElementById("orig_time").innerHTML=display_time(b.guesses/1700):document.getElementById("orig_time").innerHTML=display_time(b.guesses/3600)};function base32_encode(a){var b="",c=Math.floor(a.length/5),d=a.length%5,g,e,f,h,l,k,m,n="";0!=d&&(c+=1);for(i=0;i<c;i++)e=a.charCodeAt(5*i),h=a.charCodeAt(5*i+1),l=a.charCodeAt(5*i+2),k=a.charCodeAt(5*i+3),m=a.charCodeAt(5*i+4),g=e>>3,e=(e&7)<<2|h>>6,f=(h&63)>>1,h=(h&1)<<4|l>>4,l=(l&15)<<1|k>>7,parts6=(k&127)>>2,k=(k&3)<<3|m>>5,m&=31,b+="ybndrfg8ejkmcpqxot1uwisza345h769".charAt(g)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(e)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(f)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(h)+
"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(l)+"y"+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(k)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(m);a=0;1==d?a=6:2==d?a=4:3==d?a=3:4==d&&(a=1);d=8*i;for(i=0;i<a;i++)n+="=";return b=b.substr(0,d-a)+n}function hex_decode(a){var b=Math.ceil(a.length/2),c,d="";for(c=0;c<b;c++)d+=String.fromCharCode(parseInt(a.substr(2*c,2),16));return d}
function string_indexes(a,b){for(var c,d=0,g=[],e=0,f=0;null!==d;)c=a.substr(d),d=c.match(b),null!==d&&(g[f++]=c.indexOf(d[0])+e,e=d=c.indexOf(d[0])+1+e);return g}
function no_repeat_strings(a){for(var b="",c=a.length,d="",g=a.substr(0,1),e,f=1,h=1,l=0,k=0,m=0;1===f;)h>c&&1<=l&&100>=k?(m=m+h+k,h=1,a=b+d,a.substr(-1,1)===a.substr(-2,1)?(ins_place=m%c,a=a.substr(0,ins_place)+a.substr(-1,1)+a.substr(ins_place,c-1)):a.substr(0,1)===a.substr(1,1)&&(ins_place=m%c,a=a.substr(0,ins_place)+a.substr(-1,1)+a.substr(ins_place,c-1)),g=a.substr(0,1),l=0,f=1,b=d="",k+=1):h>c&&(f=0),e=a.substr(h,1),g==e?(b+=g,l=b.length):d+=g,g=e,h+=1;return a};function pow(a,b){return Math.pow(a,b)}function sqrt(a){return Math.sqrt(a)}function ceil(a){return Math.ceil(a)}function getint(a){return parseInt($(a).val())}function floor(a){return Math.floor(a)}function intval(a){return parseInt(a)}function rand(a,b){void 0===b&&(b=a,a=0);return Math.floor(Math.random()*(b-a))+a}function round(a,b){var c=0;void 0!==b&&(c=parseFloat(a.toFixed(b)));a=Math.round(a,5);return c!==a&&void 0!==b?parseFloat(c):parseInt(a)}
function randfloat(a,b,c){var d=Math.pow(10,c);a+=(b-a)*(rand(0,d)/d);return a=round(a,c)}function sum(a,b,c,d){for(var g;b<c;++b)g+=eval(d),++a}function mean(a){var b=a.length,c,d=0;for(c=0;c<b;++c)d+=a[c];return round(d/b,8)}function standard_deviation(a,b){var c=a.length,d,g=0;for(d=0;d<c;++d)g+=pow(a[d]-b,2);return g=round(sqrt(g/c),8)}function num_format(a){str=a+"";x=str.split(".");x1=x[0];x2=1<x.length?"."+x[1]:"";for(a=/(\d+)(\d{3})/;a.test(x1);)x1=x1.replace(a,"$1,$2");return x1+x2}
function float_bin(a){var b;b=a.split(".");var c=parseFloat("0."+b[1]),d=1;a=0;1<Math.abs(b[0])?(b=Math.abs(b[0]).toString(2),a=b.length,b+="."):b="0.";for(;0!==d&&24>a;)d=c*=2,d=Math.floor(d),b+=d,c+="",d=c.split("."),d=parseInt(d[1]),++a;c=b.split(".");a=0==parseInt(c[0])?c[0].length:c[1].length;for(c=0;c<a;++c);}function bin_float(a){}
function xor_rand(a,b){var c,d,g,e,f;c=window.screenX^window.screen.width;d=window.screenY^window.screen.height;g=Math.floor(4294967295*Math.rand());e=Math.floor(4294967295*Math.rand());e=(e^e<<1)>>3;e^=e<<10;c^=c<<16;g=c>>5^c<<1;d=(d^d>>2)<<5;d^=d>>15;var h=(e&6)+(c&6)+(d&6)+(g&6)+3,l;for(l=0;l<h;++l)e^=e<<1,e>>=3,e^=e<<10,g^=g<<1,c^=c<<16,g=c>>5,g^=c<<1,d^=d>>2,d<<=5,d^=d>>15;h*=2;for(l=0;l<h;++l)f=c^c<<20^d^d>>11^g^g<<27^e^e>>6,c=d,d=g,g=e,e=f;return a||b?Math.floor(e*(b-a))+a:e&4294967295}
function microtime(){return Date.now()/1E3}function display_time(a){var b;a=1>a?[null,"less than a second"]:60>a?(b=Math.round(a),[b,b+" second"]):3600>a?(b=Math.round(a/60),[b,b+" minute"]):86400>a?(b=Math.round(a/3600),[b,b+" hour"]):2678400>a?(b=Math.round(a/86400),[b,b+" day"]):32140800>a?(b=Math.round(a/2678400),[b,b+" month"]):321408E4>a?(b=Math.round(a/32140800),[b,b+" year"]):[null,"centuries"];b=a[0];a=a[1];null!=b&&1!==b&&(a+="s");return a};
