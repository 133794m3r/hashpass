perc=0;function generate_salt(a,c,b){var d=Date.now(),e="";scrypt(a,b,{logN:7,r:6,p:1,encoding:"base64"},function(b){a=b});scrypt(c,a,{logN:7,r:6,p:1,encoding:"hex"},function(a){c=a});scrypt(b,c,{logN:7,r:6,p:1,encoding:"base64"},function(a){b=a});e=b+a+c;salt2=c+b+a;scrypt(e,salt2,{logN:9,r:8,p:1,encoding:"hex"},function(a){e=a});var f=Date.now();console.log("gen_salt:"+(f-d)+"ms");console.log(e);return e}
function simplify(a,c,b){var d=Date.now(),e=a,f=RegExp("[0-9]","g"),l=string_indexes(a,/[0-9]/),g,k,h="",m=l.length,p,n="";p=(a.charCodeAt(1)+a.charCodeAt(1)+a.charCodeAt(2))%3;a=a.replace(f,"");a=a.replace(/\=/gi,"");f=a.substr(1);g=f=no_repeat_strings(f);f=a.substr(0,1).toUpperCase();k=e.substr(l[0],1);for(i=1;i<m;++i)h+=e.substr(l[i],1);h=no_repeat_strings(h);e=parseInt(h.substr(0,2))%3;if(!1===b)switch(e){case 0:n="$";break;case 1:n="#";break;case 2:n="@"}else n=5<=h.length?h.substr(-1,1):g.substr(-1,
1);5<=h.length?(num_str_len=Math.floor(c/2),g=g.substr(0,num_str_len-2),h=h.substr(0,c-num_str_len-1)):(c-=h.length,g=g.substr(0,c-3),h.substr(0));switch(p){case 0:a=k+f+g+h+n;break;case 1:a=f+k+g+h+n;break;case 2:a=k+f+h+g+n}c=Date.now();console.log("simplify:"+(c-d)+"ms");return a}
function generate_pass(){document.getElementsByTagName("input");var a=14,c="",b="",d="",e="",f=a=c=0,e=0,l=document.getElementById("no_spec").checked,d=document.getElementById("site_name").value,b=document.getElementById("password").value,c=document.getElementById("username").value,a=document.getElementById("length").value;""===a&&(a=14,document.getElementById("length").value=14);e=zxcvbn(b);document.getElementById("orig_score").innerHTML=e.score;document.getElementById("feedback").innerHTML=e.feedback.suggestions;
document.getElementById("orig_time").innerHTML=e.crack_times_display.offline_slow_hashing_1e4_per_second;f=Date.now();c=generate_salt(b,c,d);e=Date.now();scrypt(b,c,{logN:15,r:10,p:1,encoding:"hex"},function(a){b=a});c=Date.now();console.log("scrypt time:"+(c-e)+"ms");b=hex_decode(b);b=base32_encode(b);console.log("scrypt:"+b);b=simplify(b,a,l);b=b.substr(0,a);document.getElementById("result").value=b;a=Date.now();console.log("total:"+(a-f)+"ms");f=Date.now();e=zxcvbn(b);a=Date.now();console.log("zxcvbn:"+
(a-f)+"ms");document.getElementById("gen_score").innerHTML=e.score;document.getElementById("gen_time").innerHTML=e.crack_times_display.offline_slow_hashing_1e4_per_second;console.log(JSON.stringify(e.crack_times_display.offline_slow_hashing_1e4_per_second));modal_toggle("_progress");perc=0}function sleepFor(a){for(var c=(new Date).getTime();(new Date).getTime()<c+a;);}
function percent_update(a){var c=document.getElementById("completed_perc"),b=document.getElementById("perc_text"),d=document.getElementById("perc_done");a+="%";b.innerHTML=a;d.innerHTML=a;c.style.width=a}function modal_toggle(a){a=document.getElementById("modal"+a);a.style.visibility="visible"===a.style.visibility?"hidden":"visible"}function no_spec_check(){!0===document.getElementById("no_spec").checked&&modal_toggle("_spec")}
function confirmed(a){document.getElementById("no_spec").checked=a;modal_toggle("_spec")}function generate_wrapper(){setTimeout(function(){document.getElementById("modal_progress").style.visibility="visible"},0);setTimeout(function(){percent_update(70)},1);setTimeout(function(){generate_pass()},30)};function base32_encode(a){var c="",b=Math.floor(a.length/5),d=a.length%5,e,f,l,g,k,h,m,p="";0!=d&&(b+=1);for(i=0;i<b;i++)f=a.charCodeAt(5*i),g=a.charCodeAt(5*i+1),k=a.charCodeAt(5*i+2),h=a.charCodeAt(5*i+3),m=a.charCodeAt(5*i+4),e=f>>3,f=(f&7)<<2|g>>6,l=(g&63)>>1,g=(g&1)<<4|k>>4,k=(k&15)<<1|h>>7,parts6=(h&127)>>2,h=(h&3)<<3|m>>5,m&=31,c+="ybndrfg8ejkmcpqxot1uwisza345h769".charAt(e)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(f)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(l)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(g)+
"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(k)+"y"+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(h)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(m);a=0;1==d?a=6:2==d?a=4:3==d?a=3:4==d&&(a=1);d=8*i;for(i=0;i<a;i++)p+="=";return c=c.substr(0,d-a)+p}function hex_decode(a){var c=Math.ceil(a.length/2),b,d="";for(b=0;b<c;b++)d+=String.fromCharCode(parseInt(a.substr(2*b,2),16));return d}
function string_indexes(a,c){for(var b,d=0,e=[],f=0,l=0;null!==d;)b=a.substr(d),d=b.match(c),null!==d&&(e[l++]=b.indexOf(d[0])+f,f=d=b.indexOf(d[0])+1+f);return e}
function no_repeat_strings(a){for(var c="",b=a.length,d="",e=a.substr(0,1),f,l=1,g=1,k=0,h=0,m=0;1===l;)g>b&&1<=k&&100>=h?(m=m+g+h,g=1,a=c+d,a.substr(-1,1)===a.substr(-2,1)?(ins_place=m%b,a=a.substr(0,ins_place)+a.substr(-1,1)+a.substr(ins_place,b-1)):a.substr(0,1)===a.substr(1,1)&&(ins_place=m%b,a=a.substr(0,ins_place)+a.substr(-1,1)+a.substr(ins_place,b-1)),e=a.substr(0,1),k=0,l=1,c=d="",h+=1):g>b&&(l=0),f=a.substr(g,1),e==f?(c+=e,k=c.length):d+=e,e=f,g+=1;return a};function pow(a,c){return Math.pow(a,c)}function sqrt(a){return Math.sqrt(a)}function ceil(a){return Math.ceil(a)}function getint(a){return parseInt($(a).val())}function floor(a){return Math.floor(a)}function intval(a){return parseInt(a)}function rand(a,c){void 0===c&&(c=a,a=0);return Math.floor(Math.random()*(c-a))+a}function round(a,c){var b=0;void 0!==c&&(b=parseFloat(a.toFixed(c)));a=Math.round(a,5);return b!==a&&void 0!==c?parseFloat(b):parseInt(a)}
function randfloat(a,c,b){var d=Math.pow(10,b);a+=(c-a)*(rand(0,d)/d);return a=round(a,b)}function sum(a,c,b,d){for(var e;c<b;++c)e+=eval(d),++a}function mean(a){var c=a.length,b,d=0;for(b=0;b<c;++b)d+=a[b];return round(d/c,8)}function standard_deviation(a,c){var b=a.length,d,e=0;for(d=0;d<b;++d)e+=pow(a[d]-c,2);return e=round(sqrt(e/b),8)}function num_format(a){str=a+"";x=str.split(".");x1=x[0];x2=1<x.length?"."+x[1]:"";for(a=/(\d+)(\d{3})/;a.test(x1);)x1=x1.replace(a,"$1,$2");return x1+x2}
function float_bin(a){var c;c=a.split(".");var b=parseFloat("0."+c[1]),d=1;a=0;1<Math.abs(c[0])?(c=Math.abs(c[0]).toString(2),a=c.length,c+="."):c="0.";for(;0!==d&&24>a;)d=b*=2,d=Math.floor(d),c+=d,b+="",d=b.split("."),d=parseInt(d[1]),++a;b=c.split(".");a=0==parseInt(b[0])?b[0].length:b[1].length;for(b=0;b<a;++b);}function bin_float(a){}
function xor_rand(a,c){var b,d,e,f,l;b=window.screenX^window.screen.width;d=window.screenY^window.screen.height;e=Math.floor(4294967295*Math.rand());f=Math.floor(4294967295*Math.rand());f=(f^f<<1)>>3;f^=f<<10;b^=b<<16;e=b>>5^b<<1;d=(d^d>>2)<<5;d^=d>>15;var g=(f&6)+(b&6)+(d&6)+(e&6)+3,k;for(k=0;k<g;++k)f^=f<<1,f>>=3,f^=f<<10,e^=e<<1,b^=b<<16,e=b>>5,e^=b<<1,d^=d>>2,d<<=5,d^=d>>15;g*=2;for(k=0;k<g;++k)l=b^b<<20^d^d>>11^e^e<<27^f^f>>6,b=d,d=e,e=f,f=l;return a||c?Math.floor(f*(c-a))+a:f&4294967295}
function microtime(){return Date.now()/1E3};
