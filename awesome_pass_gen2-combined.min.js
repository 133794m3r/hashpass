function pow(a,d){return Math.pow(a,d)}function sqrt(a){return Math.sqrt(a)}function ceil(a){return Math.ceil(a)}function getint(a){return parseInt($(a).val())}function floor(a){return Math.floor(a)}function intval(a){return parseInt(a)}function rand(a,d){void 0===d&&(d=a,a=0);return Math.floor(Math.random()*(d-a))+a}function round(a,d){var c=0;void 0!==d&&(c=parseFloat(a.toFixed(d)));a=Math.round(a,5);return c!==a&&void 0!==d?parseFloat(c):parseInt(a)}
function randfloat(a,d,c){var b=Math.pow(10,c);a+=(d-a)*(rand(0,b)/b);return a=round(a,c)}function sum(a,d,c,b){for(var f;d<c;++d)f+=eval(b),++a}function mean(a){var d=a.length,c,b=0;for(c=0;c<d;++c)b+=a[c];return round(b/d,8)}function standard_deviation(a,d){var c=a.length,b,f=0;for(b=0;b<c;++b)f+=pow(a[b]-d,2);return f=round(sqrt(f/c),8)}function num_format(a){str=a+"";x=str.split(".");x1=x[0];x2=1<x.length?"."+x[1]:"";for(a=/(\d+)(\d{3})/;a.test(x1);)x1=x1.replace(a,"$1,$2");return x1+x2}
function float_bin(a){var d;d=a.split(".");var c=parseFloat("0."+d[1]),b=1;a=0;1<Math.abs(d[0])?(d=Math.abs(d[0]).toString(2),a=d.length,d+="."):d="0.";for(;0!==b&&24>a;)b=c*=2,b=Math.floor(b),d+=b,c+="",b=c.split("."),b=parseInt(b[1]),++a;c=d.split(".");a=0==parseInt(c[0])?c[0].length:c[1].length;for(c=0;c<a;++c);}function bin_float(a){}
function xor_rand(a,d){var c,b,f,e,g;c=window.screenX^window.screen.width;b=window.screenY^window.screen.height;f=Math.floor(4294967295*Math.rand());e=Math.floor(4294967295*Math.rand());e=(e^e<<1)>>3;e^=e<<10;c^=c<<16;f=c>>5^c<<1;b=(b^b>>2)<<5;b^=b>>15;var h=(e&6)+(c&6)+(b&6)+(f&6)+3,k;for(k=0;k<h;++k)e^=e<<1,e>>=3,e^=e<<10,f^=f<<1,c^=c<<16,f=c>>5,f^=c<<1,b^=b>>2,b<<=5,b^=b>>15;h*=2;for(k=0;k<h;++k)g=c^c<<20^b^b>>11^f^f<<27^e^e>>6,c=b,b=f,f=e,e=g;return a||d?Math.floor(e*(d-a))+a:e&4294967295}
function microtime(){return Date.now()/1E3};function base32_encode(a){var d="",c=Math.floor(a.length/5),b=a.length%5,f,e,g,h,k,l,m,n="";0!=b&&(c+=1);for(i=0;i<c;i++)e=a.charCodeAt(5*i),h=a.charCodeAt(5*i+1),k=a.charCodeAt(5*i+2),l=a.charCodeAt(5*i+3),m=a.charCodeAt(5*i+4),f=e>>3,e=(e&7)<<2|h>>6,g=(h&63)>>1,h=(h&1)<<4|k>>4,k=(k&15)<<1|l>>7,parts6=(l&127)>>2,l=(l&3)<<3|m>>5,m&=31,d+="ybndrfg8ejkmcpqxot1uwisza345h769".charAt(f)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(e)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(g)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(h)+
"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(k)+"y"+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(l)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(m);a=0;1==b?a=6:2==b?a=4:3==b?a=3:4==b&&(a=1);b=8*i;for(i=0;i<a;i++)n+="=";return d=d.substr(0,b-a)+n}function hex_decode(a){var d=Math.ceil(a.length/2),c,b="";for(c=0;c<d;c++)b+=String.fromCharCode(parseInt(a.substr(2*c,2),16));return b}
function string_indexes(a,d){for(var c,b=0,f=[],e=0,g=0;null!==b;)c=a.substr(b),b=c.match(d),null!==b&&(f[g++]=c.indexOf(b[0])+e,e=b=c.indexOf(b[0])+1+e);return f}
function no_repeat_strings(a){for(var d="",c=a.length,b="",f=a.substr(0,1),e,g=1,h=1,k=0,l=0,m=0;1===g;)h>c&&1<=k&&100>=l?(m=m+h+l,h=1,a=d+b,a.substr(-1,1)===a.substr(-2,1)?(ins_place=m%c,a=a.substr(0,ins_place)+a.substr(-1,1)+a.substr(ins_place,c-1)):a.substr(0,1)===a.substr(1,1)&&(ins_place=m%c,a=a.substr(0,ins_place)+a.substr(-1,1)+a.substr(ins_place,c-1)),f=a.substr(0,1),k=0,g=1,d=b="",l+=1):h>c&&(g=0),e=a.substr(h,1),f==e?(d+=f,k=d.length):b+=f,f=e,h+=1;return a};perc=0;function generate_salt(a,d,c){var b=Date.now(),f="";scrypt(a,c,{logN:7,r:6,p:1,encoding:"base64"},function(b){a=b});scrypt(d,a,{logN:7,r:6,p:1,encoding:"hex"},function(a){d=a});scrypt(c,d,{logN:7,r:6,p:1,encoding:"base64"},function(a){c=a});f=c+a+d;salt2=d+c+a;scrypt(f,salt2,{logN:9,r:8,p:1,encoding:"hex"},function(a){f=a});var e=Date.now();console.log("gen_salt:"+(e-b)+"ms");console.log(f);return f}
function simplify(a,d,c){var b=Date.now(),f=RegExp("[^a-z]","g"),e=a.replace(RegExp("[^0-9]","g"),""),g,h,k,l="";k=(a.charCodeAt(1)+a.charCodeAt(1)+a.charCodeAt(2))%3;a=a.replace(f,"");console.log(a);var m,f=a.substr(1);g=f=no_repeat_strings(f);f=a.substr(0,1).toUpperCase();h=e.substr(0,1);e=e.substr(1);e=no_repeat_strings(e);m=parseInt(e.substr(0,2))%3;if(!1===c)switch(m){case 0:l="$";break;case 1:l="#";break;case 2:l="@"}else l=5<=e.length?e.substr(-1,1):g.substr(-1,1);5<=e.length?(num_str_len=
Math.floor(d/2),g=g.substr(0,num_str_len-2),e=e.substr(0,d-num_str_len-1)):(d-=e.length,g=g.substr(0,d-3),e.substr(0));switch(k){case 0:a=h+f+g+e+l;break;case 1:a=f+h+g+e+l;break;case 2:a=h+f+e+g+l}d=Date.now();console.log("simplify:"+(d-b)+"ms");return a}
function generate_pass(){document.getElementsByTagName("input");var a=14,d=[],c="",b="",f="",e="",g=a=c=0,e=0,h=document.getElementById("no_spec").checked,f=document.getElementById("site_name").value,b=document.getElementById("password").value,c=document.getElementById("username").value,a=document.getElementById("length").value;d[0]=c;d[1]=f;""===a&&(a=14,document.getElementById("length").value=14);e=zxcvbn(b,d);console.log(e.guesses);document.getElementById("orig_score").innerHTML=e.score;1>=e.score&&
d[0]==d[1]?document.getElementById("feedback").innerHTML="Do not use your username or site name in the password! Also try adding a word or two, less common are better. Or try adding a few numbers.":1>=e.score&&(document.getElementById("feedback").innerHTML="Try adding a word or two, less common are better. Or try adding a few numbers.");document.getElementById("orig_time").innerHTML=e.crack_times_display.offline_slow_hashing_1e4_per_second;g=Date.now();c=generate_salt(b,c,f);e=Date.now();scrypt(b,
c,{logN:15,r:10,p:1,encoding:"hex"},function(a){b=a});c=Date.now();console.log("scrypt time:"+(c-e)+"ms");b=hex_decode(b);b=base32_encode(b);console.log("scrypt:"+b);b=simplify(b,a,h);b=b.substr(0,a);document.getElementById("result").value=b;a=Date.now();console.log("total:"+(a-g)+"ms");g=Date.now();e=zxcvbn(b,d);a=Date.now();console.log("zxcvbn:"+(a-g)+"ms");document.getElementById("gen_score").innerHTML=e.score;document.getElementById("gen_time").innerHTML=e.crack_times_display.offline_slow_hashing_1e4_per_second;
console.log(JSON.stringify(e.crack_times_display.offline_slow_hashing_1e4_per_second));modal_toggle("_progress");perc=0}function percent_update(a){var d=document.getElementById("completed_perc"),c=document.getElementById("perc_text"),b=document.getElementById("perc_done");a+="%";c.innerHTML=a;b.innerHTML=a;d.style.width=a}function modal_toggle(a){a=document.getElementById("modal"+a);a.style.visibility="visible"===a.style.visibility?"hidden":"visible"}
function no_spec_check(){!0===document.getElementById("no_spec").checked&&modal_toggle("_spec")}function confirmed(a){document.getElementById("no_spec").checked=a;modal_toggle("_spec")}function generate_wrapper(){setTimeout(function(){document.getElementById("modal_progress").style.visibility="visible"},0);setTimeout(function(){percent_update(70)},1);setTimeout(function(){generate_pass()},30)};
