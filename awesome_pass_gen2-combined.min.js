function pow(a,d){return Math.pow(a,d)}function sqrt(a){return Math.sqrt(a)}function ceil(a){return Math.ceil(a)}function getint(a){return parseInt($(a).val())}function floor(a){return Math.floor(a)}function intval(a){return parseInt(a)}function rand(a,d){void 0===d&&(d=a,a=0);return Math.floor(Math.random()*(d-a))+a}function round(a,d){var b=0;void 0!==d&&(b=parseFloat(a.toFixed(d)));a=Math.round(a,5);return b!==a&&void 0!==d?parseFloat(b):parseInt(a)}
function randfloat(a,d,b){var c=Math.pow(10,b);a+=(d-a)*(rand(0,c)/c);return a=round(a,b)}function sum(a,d,b,c){for(var e;d<b;++d)e+=eval(c),++a}function mean(a){var d=a.length,b,c=0;for(b=0;b<d;++b)c+=a[b];return round(c/d,8)}function standard_deviation(a,d){var b=a.length,c,e=0;for(c=0;c<b;++c)e+=pow(a[c]-d,2);return e=round(sqrt(e/b),8)}function num_format(a){str=a+"";x=str.split(".");x1=x[0];x2=1<x.length?"."+x[1]:"";for(a=/(\d+)(\d{3})/;a.test(x1);)x1=x1.replace(a,"$1,$2");return x1+x2}
function float_bin(a){var d;d=a.split(".");var b=parseFloat("0."+d[1]),c=1;a=0;1<Math.abs(d[0])?(d=Math.abs(d[0]).toString(2),a=d.length,d+="."):d="0.";for(;0!==c&&24>a;)c=b*=2,c=Math.floor(c),d+=c,b+="",c=b.split("."),c=parseInt(c[1]),++a;b=d.split(".");a=0==parseInt(b[0])?b[0].length:b[1].length;for(b=0;b<a;++b);}function bin_float(a){}
function xor_rand(a,d){var b,c,e,f,g;b=window.screenX^window.screen.width;c=window.screenY^window.screen.height;e=Math.floor(4294967295*Math.rand());f=Math.floor(4294967295*Math.rand());f=(f^f<<1)>>3;f^=f<<10;b^=b<<16;e=b>>5^b<<1;c=(c^c>>2)<<5;c^=c>>15;var h=(f&6)+(b&6)+(c&6)+(e&6)+3,k;for(k=0;k<h;++k)f^=f<<1,f>>=3,f^=f<<10,e^=e<<1,b^=b<<16,e=b>>5,e^=b<<1,c^=c>>2,c<<=5,c^=c>>15;h*=2;for(k=0;k<h;++k)g=b^b<<20^c^c>>11^e^e<<27^f^f>>6,b=c,c=e,e=f,f=g;return a||d?Math.floor(f*(d-a))+a:f&4294967295}
function microtime(){return Date.now()/1E3};function base32_encode(a){var d="",b=Math.floor(a.length/5),c=a.length%5,e,f,g,h,k,l,m,n="";0!=c&&(b+=1);for(i=0;i<b;i++)f=a.charCodeAt(5*i),h=a.charCodeAt(5*i+1),k=a.charCodeAt(5*i+2),l=a.charCodeAt(5*i+3),m=a.charCodeAt(5*i+4),e=f>>3,f=(f&7)<<2|h>>6,g=(h&63)>>1,h=(h&1)<<4|k>>4,k=(k&15)<<1|l>>7,parts6=(l&127)>>2,l=(l&3)<<3|m>>5,m&=31,d+="ybndrfg8ejkmcpqxot1uwisza345h769".charAt(e)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(f)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(g)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(h)+
"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(k)+"y"+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(l)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(m);a=0;1==c?a=6:2==c?a=4:3==c?a=3:4==c&&(a=1);c=8*i;for(i=0;i<a;i++)n+="=";return d=d.substr(0,c-a)+n}function hex_decode(a){var d=Math.ceil(a.length/2),b,c="";for(b=0;b<d;b++)c+=String.fromCharCode(parseInt(a.substr(2*b,2),16));return c}
function string_indexes(a,d){for(var b,c=0,e=[],f=0,g=0;null!==c;)b=a.substr(c),c=b.match(d),null!==c&&(e[g++]=b.indexOf(c[0])+f,f=c=b.indexOf(c[0])+1+f);return e}
function no_repeat_strings(a){for(var d="",b=a.length,c="",e=a.substr(0,1),f,g=1,h=1,k=0,l=0,m=0;1===g;)h>b&&1<=k&&100>=l?(m=m+h+l,h=1,a=d+c,a.substr(-1,1)===a.substr(-2,1)?(ins_place=m%b,a=a.substr(0,ins_place)+a.substr(-1,1)+a.substr(ins_place,b-1)):a.substr(0,1)===a.substr(1,1)&&(ins_place=m%b,a=a.substr(0,ins_place)+a.substr(-1,1)+a.substr(ins_place,b-1)),e=a.substr(0,1),k=0,g=1,d=c="",l+=1):h>b&&(g=0),f=a.substr(h,1),e==f?(d+=e,k=d.length):c+=e,e=f,h+=1;return a};perc=0;function generate_salt(a,d,b){var c=Date.now(),e="";scrypt(a,b,{logN:7,r:6,p:1,encoding:"base64"},function(b){a=b});scrypt(d,a,{logN:7,r:6,p:1,encoding:"hex"},function(a){d=a});scrypt(b,d,{logN:7,r:6,p:1,encoding:"base64"},function(a){b=a});e=b+a+d;salt2=d+b+a;scrypt(e,salt2,{logN:9,r:8,p:1,encoding:"hex"},function(a){e=a});var f=Date.now();console.log("gen_salt:"+(f-c)+"ms");console.log(e);return e}
function simplify(a,d,b){var c=Date.now(),e=RegExp("[^a-z]","g"),f=a.replace(RegExp("[^0-9]","g"),""),g,h,k,l="";k=(a.charCodeAt(1)+a.charCodeAt(1)+a.charCodeAt(2))%3;a=a.replace(e,"");console.log(a);var m,e=a.substr(1);g=e=no_repeat_strings(e);e=a.substr(0,1).toUpperCase();h=f.substr(0,1);f=f.substr(1);f=no_repeat_strings(f);m=parseInt(f.substr(0,2))%3;if(!1===b)switch(m){case 0:l="$";break;case 1:l="#";break;case 2:l="@"}else l=5<=f.length?f.substr(-1,1):g.substr(-1,1);5<=f.length?(num_str_len=
Math.floor(d/2),g=g.substr(0,num_str_len-2),f=f.substr(0,d-num_str_len-1)):(d-=f.length,g=g.substr(0,d-3),f.substr(0));switch(k){case 0:a=h+e+g+f+l;break;case 1:a=e+h+g+f+l;break;case 2:a=h+e+f+g+l}d=Date.now();console.log("simplify:"+(d-c)+"ms");return a}
function generate_pass(){document.getElementsByTagName("input");var a="",d=14,b=[],c="",e="",f="",g="",g=a=d=c=0,a=a="",h=document.getElementById("no_spec").checked,f=document.getElementById("site_name").value,e=document.getElementById("password").value,c=document.getElementById("username").value,d=document.getElementById("length").value;b[0]=c;b[1]=f;""===d&&(d=14,document.getElementById("length").value=14);g=zxcvbn(e,b);a=g.feedback.warning;console.log(g.guesses);console.log(a);a="Try adding a word or two, less common words are better. Or try adding a few numbers. "+
a;document.getElementById("orig_score").innerHTML=g.score;1>=g.score&&(b[0]==b[1]||b[0]==e||b[1]==e)?document.getElementById("feedback").innerHTML="Do not use your username or site name in the password! "+a:1>=g.score&&(console.log("hit"),document.getElementById("feedback").innerHTML=a);document.getElementById("orig_time").innerHTML=g.crack_times_display.offline_slow_hashing_1e4_per_second;a=Date.now();c=generate_salt(e,c,f);g=Date.now();scrypt(e,c,{logN:15,r:10,p:1,encoding:"hex"},function(a){e=
a});c=Date.now();console.log("scrypt time:"+(c-g)+"ms");e=hex_decode(e);e=base32_encode(e);console.log("scrypt:"+e);e=simplify(e,d,h);e=e.substr(0,d);document.getElementById("result").value=e;d=Date.now();console.log("total:"+(d-a)+"ms");a=Date.now();g=zxcvbn(e,b);d=Date.now();console.log("zxcvbn:"+(d-a)+"ms");document.getElementById("gen_score").innerHTML=g.score;document.getElementById("gen_time").innerHTML=g.crack_times_display.offline_slow_hashing_1e4_per_second;console.log(JSON.stringify(g.crack_times_display.offline_slow_hashing_1e4_per_second));
modal_toggle("_progress");perc=0}function percent_update(a){var d=document.getElementById("completed_perc"),b=document.getElementById("perc_text"),c=document.getElementById("perc_done");a+="%";b.innerHTML=a;c.innerHTML=a;d.style.width=a}function modal_toggle(a){a=document.getElementById("modal"+a);a.style.visibility="visible"===a.style.visibility?"hidden":"visible"}function no_spec_check(){!0===document.getElementById("no_spec").checked&&modal_toggle("_spec")}
function confirmed(a){document.getElementById("no_spec").checked=a;modal_toggle("_spec")}function generate_wrapper(){setTimeout(function(){document.getElementById("modal_progress").style.visibility="visible"},0);setTimeout(function(){percent_update(70)},1);setTimeout(function(){generate_pass()},30)};
