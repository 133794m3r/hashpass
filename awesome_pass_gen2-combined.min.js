perc=0;function generate_salt(a,b,d){var c=Date.now(),e="";scrypt(a,d,{logN:7,r:6,p:1,encoding:"base64"},function(b){a=b});scrypt(b,a,{logN:7,r:6,p:1,encoding:"hex"},function(a){b=a});scrypt(d,b,{logN:7,r:6,p:1,encoding:"base64"},function(a){d=a});e=d+a+b;salt2=b+d+a;scrypt(e,salt2,{logN:9,r:8,p:1,encoding:"hex"},function(a){e=a});var f=Date.now();console.log("gen_salt:"+(f-c)+"ms");console.log(e);return e}
function simplify(a,b,d){var c=Date.now(),e=RegExp("[^a-z]","g"),f=a.replace(RegExp("[^0-9]","g"),""),g,h,l,k="";l=(a.charCodeAt(1)+a.charCodeAt(1)+a.charCodeAt(2))%5;a=a.replace(e,"");console.log(a);var m,e=a.substr(1);g=e=no_repeat_strings(e);e=a.substr(0,1).toUpperCase();h=f.substr(0,1);f=f.substr(1);f=no_repeat_strings(f);m=parseInt(f.substr(0,2))%3;if(!1===d)switch(m){case 0:k="$";break;case 1:k="#";break;case 2:k="@"}else k=5<=f.length?f.substr(-1,1):g.substr(-1,1);5<=f.length?(num_str_len=
Math.floor(b/2),g=g.substr(0,num_str_len-2),f=f.substr(0,b-num_str_len-1)):(b-=f.length,g=g.substr(0,b-3),f.substr(0));switch(l){case 0:a=h+e+g+f+k;break;case 1:a=e+h+g+f+k;break;case 2:a=h+e+f+g+k;break;case 3:a=f+e+g+h+k;break;case 4:a=f+e+h+g+k}b=Date.now();console.log("simplify:"+(b-c)+"ms");return a}
function generate_pass(){document.getElementsByTagName("input");var a="",b=14,d=[],c="",e="",f="",g="",g=a=b=c=0,a=a="",h=document.getElementById("no_spec").checked,f=document.getElementById("site_name").value,e=document.getElementById("password").value,c=document.getElementById("username").value,b=document.getElementById("length").value;d[0]=c;d[1]=f;""===b&&(b=14,document.getElementById("length").value=14);""!==e&&(a=e.length,e=e.substr(0,1).toUpperCase()+e.substr(1,a),document.getElementById("password").value=
e);""!==c&&(c=c.substr(0,1).toUpperCase()+c.substr(1),document.getElementById("username").value=c);""!==f&&(f=f.substr(0,1).toUpperCase()+f.substr(1),document.getElementById("site_name").value=f);a="";g=zxcvbn(e,d);a=g.feedback.warning;console.log(g.guesses);console.log(a);a="Try adding a word or two, less common words are better. Or try adding a few numbers. "+a;document.getElementById("orig_score").innerHTML=g.score;1>=g.score&&(d[0]==d[1]||d[0]==e||d[1]==e)?document.getElementById("feedback").innerHTML=
"Do not use your username or site name in the password! "+a:1>=g.score&&(console.log("hit"),document.getElementById("feedback").innerHTML=a);document.getElementById("orig_time").innerHTML=display_time(g.guesses/3E3);a=Date.now();c=generate_salt(e,c,f);g=Date.now();scrypt(e,c,{logN:15,r:10,p:1,encoding:"hex"},function(a){e=a});c=Date.now();console.log("scrypt time:"+(c-g)+"ms");e=hex_decode(e);e=base32_encode(e);console.log("scrypt:"+e);e=simplify(e,b,h);e=e.substr(0,b);document.getElementById("result").value=
e;b=Date.now();console.log("total:"+(b-a)+"ms");a=Date.now();g=zxcvbn(e,d);b=Date.now();console.log("zxcvbn:"+(b-a)+"ms");document.getElementById("gen_score").innerHTML=g.score;document.getElementById("gen_time").innerHTML=display_time(g.guesses/2E3);modal_toggle("_progress");perc=0}function percent_update(a){var b=document.getElementById("completed_perc"),d=document.getElementById("perc_text"),c=document.getElementById("perc_done");a+="%";d.innerHTML=a;c.innerHTML=a;b.style.width=a}
function modal_toggle(a){a=document.getElementById("modal"+a);a.style.visibility="visible"===a.style.visibility?"hidden":"visible"}function no_spec_check(){!0===document.getElementById("no_spec").checked&&modal_toggle("_spec")}function confirmed(a){document.getElementById("no_spec").checked=a;modal_toggle("_spec")}
function generate_wrapper(){setTimeout(function(){document.getElementById("modal_progress").style.visibility="visible"},0);setTimeout(function(){percent_update(70)},1);setTimeout(function(){generate_pass()},30)};function base32_encode(a){var b="",d=Math.floor(a.length/5),c=a.length%5,e,f,g,h,l,k,m,n="";0!=c&&(d+=1);for(i=0;i<d;i++)f=a.charCodeAt(5*i),h=a.charCodeAt(5*i+1),l=a.charCodeAt(5*i+2),k=a.charCodeAt(5*i+3),m=a.charCodeAt(5*i+4),e=f>>3,f=(f&7)<<2|h>>6,g=(h&63)>>1,h=(h&1)<<4|l>>4,l=(l&15)<<1|k>>7,parts6=(k&127)>>2,k=(k&3)<<3|m>>5,m&=31,b+="ybndrfg8ejkmcpqxot1uwisza345h769".charAt(e)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(f)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(g)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(h)+
"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(l)+"y"+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(k)+"ybndrfg8ejkmcpqxot1uwisza345h769".charAt(m);a=0;1==c?a=6:2==c?a=4:3==c?a=3:4==c&&(a=1);c=8*i;for(i=0;i<a;i++)n+="=";return b=b.substr(0,c-a)+n}function hex_decode(a){var b=Math.ceil(a.length/2),d,c="";for(d=0;d<b;d++)c+=String.fromCharCode(parseInt(a.substr(2*d,2),16));return c}
function string_indexes(a,b){for(var d,c=0,e=[],f=0,g=0;null!==c;)d=a.substr(c),c=d.match(b),null!==c&&(e[g++]=d.indexOf(c[0])+f,f=c=d.indexOf(c[0])+1+f);return e}
function no_repeat_strings(a){for(var b="",d=a.length,c="",e=a.substr(0,1),f,g=1,h=1,l=0,k=0,m=0;1===g;)h>d&&1<=l&&100>=k?(m=m+h+k,h=1,a=b+c,a.substr(-1,1)===a.substr(-2,1)?(ins_place=m%d,a=a.substr(0,ins_place)+a.substr(-1,1)+a.substr(ins_place,d-1)):a.substr(0,1)===a.substr(1,1)&&(ins_place=m%d,a=a.substr(0,ins_place)+a.substr(-1,1)+a.substr(ins_place,d-1)),e=a.substr(0,1),l=0,g=1,b=c="",k+=1):h>d&&(g=0),f=a.substr(h,1),e==f?(b+=e,l=b.length):c+=e,e=f,h+=1;return a};function pow(a,b){return Math.pow(a,b)}function sqrt(a){return Math.sqrt(a)}function ceil(a){return Math.ceil(a)}function getint(a){return parseInt($(a).val())}function floor(a){return Math.floor(a)}function intval(a){return parseInt(a)}function rand(a,b){void 0===b&&(b=a,a=0);return Math.floor(Math.random()*(b-a))+a}function round(a,b){var d=0;void 0!==b&&(d=parseFloat(a.toFixed(b)));a=Math.round(a,5);return d!==a&&void 0!==b?parseFloat(d):parseInt(a)}
function randfloat(a,b,d){var c=Math.pow(10,d);a+=(b-a)*(rand(0,c)/c);return a=round(a,d)}function sum(a,b,d,c){for(var e;b<d;++b)e+=eval(c),++a}function mean(a){var b=a.length,d,c=0;for(d=0;d<b;++d)c+=a[d];return round(c/b,8)}function standard_deviation(a,b){var d=a.length,c,e=0;for(c=0;c<d;++c)e+=pow(a[c]-b,2);return e=round(sqrt(e/d),8)}function num_format(a){str=a+"";x=str.split(".");x1=x[0];x2=1<x.length?"."+x[1]:"";for(a=/(\d+)(\d{3})/;a.test(x1);)x1=x1.replace(a,"$1,$2");return x1+x2}
function float_bin(a){var b;b=a.split(".");var d=parseFloat("0."+b[1]),c=1;a=0;1<Math.abs(b[0])?(b=Math.abs(b[0]).toString(2),a=b.length,b+="."):b="0.";for(;0!==c&&24>a;)c=d*=2,c=Math.floor(c),b+=c,d+="",c=d.split("."),c=parseInt(c[1]),++a;d=b.split(".");a=0==parseInt(d[0])?d[0].length:d[1].length;for(d=0;d<a;++d);}function bin_float(a){}
function xor_rand(a,b){var d,c,e,f,g;d=window.screenX^window.screen.width;c=window.screenY^window.screen.height;e=Math.floor(4294967295*Math.rand());f=Math.floor(4294967295*Math.rand());f=(f^f<<1)>>3;f^=f<<10;d^=d<<16;e=d>>5^d<<1;c=(c^c>>2)<<5;c^=c>>15;var h=(f&6)+(d&6)+(c&6)+(e&6)+3,l;for(l=0;l<h;++l)f^=f<<1,f>>=3,f^=f<<10,e^=e<<1,d^=d<<16,e=d>>5,e^=d<<1,c^=c>>2,c<<=5,c^=c>>15;h*=2;for(l=0;l<h;++l)g=d^d<<20^c^c>>11^e^e<<27^f^f>>6,d=c,c=e,e=f,f=g;return a||b?Math.floor(f*(b-a))+a:f&4294967295}
function microtime(){return Date.now()/1E3}function display_time(a){var b;a=1>a?[null,"less than a second"]:60>a?(b=Math.round(a),[b,b+" second"]):3600>a?(b=Math.round(a/60),[b,b+" minute"]):86400>a?(b=Math.round(a/3600),[b,b+" hour"]):2678400>a?(b=Math.round(a/86400),[b,b+" day"]):32140800>a?(b=Math.round(a/2678400),[b,b+" month"]):321408E4>a?(b=Math.round(a/32140800),[b,b+" year"]):[null,"centuries"];b=a[0];a=a[1];null!=b&&1!==b&&(a+="s");return a};
