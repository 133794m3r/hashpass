function scrypt(I,X,n,l,A,Z,aa){function J(d){function f(d,f){for(var v=0;64<=f;){var x=g,C=h,m=M,u=p,y=l,n=P,B=q,D=R,r;for(r=0;16>r;r++){var z=v+4*r;E[r]=(d[z]&255)<<24|(d[z+1]&255)<<16|(d[z+2]&255)<<8|d[z+3]&255}for(r=16;64>r;r++){var w=E[r-2];z=(w>>>17|w<<15)^(w>>>19|w<<13)^w>>>10;w=E[r-15];w=(w>>>7|w<<25)^(w>>>18|w<<14)^w>>>3;E[r]=(z+E[r-7]|0)+(w+E[r-16]|0)|0}for(r=0;64>r;r++)z=(((y>>>6|y<<26)^(y>>>11|y<<21)^(y>>>25|y<<7))+(y&n^~y&B)|0)+(D+(k[r]+E[r]|0)|0)|0,w=((x>>>2|x<<30)^(x>>>13|x<<19)^(x>>>
22|x<<10))+(x&C^x&m^C&m)|0,D=B,B=n,n=y,y=u+z|0,u=m,m=C,C=x,x=z+w|0;g=g+x|0;h=h+C|0;M=M+m|0;p=p+u|0;l=l+y|0;P=P+n|0;q=q+B|0;R=R+D|0;v+=64;f-=64}}var k=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,
773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],g=1779033703,h=3144134277,M=1013904242,p=2773480762,l=1359893119,P=2600822924,q=528734635,R=1541459225,E=Array(64),v=d.length;f(d,v);var m=v%64;var u=v/536870912|0,n=
v<<3,A=56>m?56:120;d=d.slice(v-m,v);v=d.length;d[v++]=128;for(m+=1;m<A;m++)d[v++]=0;d[v++]=u>>>24&255;d[v++]=u>>>16&255;d[v++]=u>>>8&255;d[v++]=u>>>0&255;d[v++]=n>>>24&255;d[v++]=n>>>16&255;d[v++]=n>>>8&255;d[v++]=n>>>0&255;f(d,v);return[g>>>24&255,g>>>16&255,g>>>8&255,g>>>0&255,h>>>24&255,h>>>16&255,h>>>8&255,h>>>0&255,M>>>24&255,M>>>16&255,M>>>8&255,M>>>0&255,p>>>24&255,p>>>16&255,p>>>8&255,p>>>0&255,l>>>24&255,l>>>16&255,l>>>8&255,l>>>0&255,P>>>24&255,P>>>16&255,P>>>8&255,P>>>0&255,q>>>24&255,
q>>>16&255,q>>>8&255,q>>>0&255,R>>>24&255,R>>>16&255,R>>>8&255,R>>>0&255]}function ba(d,f,k){function g(){for(var d=l-1;d>=l-4;d--){p[d]++;if(255>=p[d])break;p[d]=0}}d=64>=d.length?d:J(d);var h,l=64+f.length+4,p=Array(l),C=Array(64),m=[],q=d.length,u=f.length;for(h=0;64>h;h++)p[h]=54;for(h=0;h<q;h++)p[h]^=d[h];for(h=0;h<u;h++)p[64+h]=f[h];for(h=l-4;h<l;h++)p[h]=0;for(h=0;64>h;h++)C[h]=92;for(h=0;h<q;h++)C[h]^=d[h];for(;32<=k;)g(),m=m.concat(J(C.concat(J(p)))),k-=32;0<k&&(g(),m=m.concat(J(C.concat(J(p))).slice(0,
k)));return m}function ca(d,f,k,g){var h=d[0]^f[k++],l=d[1]^f[k++],p=d[2]^f[k++],m=d[3]^f[k++],q=d[4]^f[k++],u=d[5]^f[k++],n=d[6]^f[k++],E=d[7]^f[k++],v=d[8]^f[k++],A=d[9]^f[k++],F=d[10]^f[k++],G=d[11]^f[k++],I=d[12]^f[k++],J=d[13]^f[k++],K=d[14]^f[k++];k=d[15]^f[k++];var H,x=h,L=l,N=p,O=m,y=q,Q=u,B=n,D=E,r=v,z=A,w=F,S=G,T=I,U=J,V=K,W=k;for(H=0;8>H;H+=2){var e=x+T;y^=e<<7|e>>>25;e=y+x;r^=e<<9|e>>>23;e=r+y;T^=e<<13|e>>>19;e=T+r;x^=e<<18|e>>>14;e=Q+L;z^=e<<7|e>>>25;e=z+Q;U^=e<<9|e>>>23;e=U+z;L^=e<<
13|e>>>19;e=L+U;Q^=e<<18|e>>>14;e=w+B;V^=e<<7|e>>>25;e=V+w;N^=e<<9|e>>>23;e=N+V;B^=e<<13|e>>>19;e=B+N;w^=e<<18|e>>>14;e=W+S;O^=e<<7|e>>>25;e=O+W;D^=e<<9|e>>>23;e=D+O;S^=e<<13|e>>>19;e=S+D;W^=e<<18|e>>>14;e=x+O;L^=e<<7|e>>>25;e=L+x;N^=e<<9|e>>>23;e=N+L;O^=e<<13|e>>>19;e=O+N;x^=e<<18|e>>>14;e=Q+y;B^=e<<7|e>>>25;e=B+Q;D^=e<<9|e>>>23;e=D+B;y^=e<<13|e>>>19;e=y+D;Q^=e<<18|e>>>14;e=w+z;S^=e<<7|e>>>25;e=S+w;r^=e<<9|e>>>23;e=r+S;z^=e<<13|e>>>19;e=z+r;w^=e<<18|e>>>14;e=W+V;T^=e<<7|e>>>25;e=T+W;U^=e<<9|e>>>
23;e=U+T;V^=e<<13|e>>>19;e=V+U;W^=e<<18|e>>>14}f[g++]=d[0]=x+h|0;f[g++]=d[1]=L+l|0;f[g++]=d[2]=N+p|0;f[g++]=d[3]=O+m|0;f[g++]=d[4]=y+q|0;f[g++]=d[5]=Q+u|0;f[g++]=d[6]=B+n|0;f[g++]=d[7]=D+E|0;f[g++]=d[8]=r+v|0;f[g++]=d[9]=z+A|0;f[g++]=d[10]=w+F|0;f[g++]=d[11]=S+G|0;f[g++]=d[12]=T+I|0;f[g++]=d[13]=U+J|0;f[g++]=d[14]=V+K|0;f[g++]=d[15]=W+k|0}function Y(d,f,k,g,h){for(var l=0,m=k+16*(2*h-1),q=16;q--;)d[l++]=f[m++];for(l=0;l<2*h;l+=2)ca(d,f,k+16*l,g+8*l),ca(d,f,k+16*l+16,g+8*l+16*h)}function da(d){for(var f=
[],k=d.length,g=0;g<k;g++){var h=d.charCodeAt(g);128>h?f.push(h):(127<h&&2048>h?f.push(h>>6|192):(f.push(h>>12|224),f.push(h>>6&63|128)),f.push(h&63|128))}return f}function ea(d){for(var f="0123456789abcdef".split(""),k=d.length,g=[],h=0;h<k;h++)g.push(f[d[h]>>>4&15]),g.push(f[d[h]>>>0&15]);return g.join("")}if("object"===typeof n){if(4<arguments.length)throw Error("scrypt: incorrect number of arguments");var m=n;n=m.logN;if("undefined"===typeof n)if("undefined"!==typeof m.N){if(2>m.N||4294967295<
m.N)throw Error("scrypt: N is out of range");if(0!==(m.N&m.N-1))throw Error("scrypt: N is not a power of 2");n=Math.log(m.N)/Math.LN2}else throw Error("scrypt: missing N parameter");A=m.p||1;l=m.r;Z=m.dkLen||32;aa=m.encoding}if(1>A)throw Error("scrypt: invalid p");if(0>=l)throw Error("scrypt: invalid r");if(1>n||31<n)throw Error("scrypt: logN must be between 1 and 31");var G=1<<n>>>0;if(1073741824<=l*A||l>3.35544319921875E7/A||1.677721599609375E7<l||G>3.35544319921875E7/l)throw Error("scrypt: parameters are too large");
"string"===typeof I&&(I=da(I));"string"===typeof X&&(X=da(X));if("undefined"!==typeof Int32Array){var q=new Int32Array(64*l);var K=new Int32Array(32*G*l);var H=new Int32Array(16);var u=new Int32Array(128*A*l)}else q=[],K=[],H=Array(16),u=[];u=ba(I,X,128*A*l);var F=32*l;return function(){for(var d=0;d<A;d++){for(var f=128*d*l,k=0;k<32*l;k++){var g=f+4*k;q[0+k]=(u[g+3]&255)<<24|(u[g+2]&255)<<16|(u[g+1]&255)<<8|(u[g+0]&255)<<0}f=G;for(k=0;k<f;k+=2){g=K;for(var h=32*k*l,m=q,p=0,n=32*l;n--;)g[h++]=m[p++];
Y(H,q,0,F,l);g=K;h=32*(k+1)*l;m=q;p=F;for(n=32*l;n--;)g[h++]=m[p++];Y(H,q,F,0,l)}f=G;for(k=0;k<f;k+=2){g=q[16*(2*l-1)]&G-1;h=q;m=0;p=K;g*=32*l;for(n=32*l;n--;)h[m++]^=p[g++];Y(H,q,0,F,l);g=q[F+16*(2*l-1)]&G-1;h=q;m=F;p=K;g*=32*l;for(n=32*l;n--;)h[m++]^=p[g++];Y(H,q,F,0,l)}f=128*d*l;for(k=0;k<32*l;k++)g=q[0+k],u[f+4*k+0]=g>>>0&255,u[f+4*k+1]=g>>>8&255,u[f+4*k+2]=g>>>16&255,u[f+4*k+3]=g>>>24&255}d=aa;f=ba(I,u,Z);if("base64"===d){d=f;f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");
k=d.length;g=[];i=0;a;b;c;for(t;i<k;)a=i<k?d[i++]:0,b=i<k?d[i++]:0,c=i<k?d[i++]:0,t=(a<<16)+(b<<8)+c,g.push(f[t>>>18&63]),g.push(f[t>>>12&63]),g.push(f[t>>>6&63]),g.push(f[t>>>0&63]);0<k%3&&(g[g.length-1]="=",1===k%3&&(g[g.length-2]="="));d=g.join("")}else d="hex"===d?ea(f):"binary"===d?new Uint8Array(f):ea(f);return d}()};
